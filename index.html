<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link rel="shortcut icon" href="./build/icon.png" type="image/vnd.microsoft.icon">
  <title>FEGS Scoping Tool</title>
  <link type="text/css" rel="stylesheet" href="./css/s.css" media="all" />
  <style>
    html,
    body {
      border: 0;
      font-size: 14pt;
      margin: 0;
      padding: 0;
      vertical-align: baseline;
      background-color: #e4e2e0;
    }

    *,
    *:before,
    *:after {
      box-sizing: border-box;
    }
    
    section {
      display: block;
    }

    body {
      line-height: 1;
    }

    @media screen and (max-width: 1680px) {
      body {
        font-size: 13pt;
      }
    }

    @media screen and (max-width: 1280px) {
      body {
        font-size: 12pt;
      }
    }

    @media screen and (max-width: 360px) {
      body {
        font-size: 11pt;
      }
    }

    .wrapper {
      position: relative
    }

    .wrapper > .inner {
      padding: 5em 5em 3em 5em;
      max-width: 100%;
      width: 75em;
    }

    @media screen and (max-width: 1680px) {
      .wrapper > .inner {
        padding: 4em 4em 2em 4em;
      }
    }

    @media screen and (max-width: 1280px) {
      .wrapper > .inner {
        width: 100%;
      }
    }

    @media screen and (max-width: 736px) {
      .wrapper > .inner {
        padding: 3em 2em 1em 2em;
      }
    }

    #page-zoom-indicator {
      display: inline-block;
      width: 3em;
    }
    
    [aria-hidden="true"] {
      display: none;
    }
    
    .magnitude {
      background: #4f81bd;
    }
    
    .influence {
      background: #c0504d;
    }
    
    .interest {
      background: #9bbb59;
    }
    
    .urgency {
      background: #8064a2;
    }
    
    .proximity {
      background: #4bacc6;
    }
    
    .economic-interest {
      background: #f79646;
    }
    
    .rights {
      background: #2c4d75;
    }
    
    .fairness {
      background: #772c2a;
    }
    
    .representation {
      background: #5f7530;
    }
    
    .agricultural {
      background: #DDD9C4;
    }
    
    .commercial {
      background: #C5D9F1;
    }
    
    .governmental {
      background: #E4DFEC;
    }
    
    .transportation {
      background: #F2DCDB;
    }
    
    .subsistence {
      background: #F9FDD1;
    }
    
    .recreational {
      background: #DAEEF3;
    }
    
    .inspirational {
      background: #EBF1DE;
    }
    
    .learning {
      background: #FDE9D9;
    }
    
    .nonuse {
      background: #F2F2F2;
    }

    .irrigators {
      background: #DDD9C3;
    }

    .cafo-operators {
      background: #C4BD97;
    }

    .livestock-grazers {
      background: #948A54;
    }

    .agricultural-processors {
      background: #948A54;
    }

    .aquaculturalists {
      background: #4A452A;
    }

    .farmers {
      background: #1E1C11;
    }

    .foresters {
      background: #050503;
    }

    .food-extractors {
      background: #DCE6F2;
    }

    .timber-fiber-ornamental-extractors {
      background: #C6D9F1;
    }

    .industrial-processors {
      background: #8EB4E3;
    }

    .industrial-dischargers {
      background: #558ED5;
    }

    .energy-generators {
      background: #376092;
    }

    .resource-dependent-businesses {
      background: #1F497D;
    }

    .pharmaceutical-food-supplement-suppliers {
      background: #254061;
    }

    .fur-hide-trappers-hunters {
      background: #10253F;
    }

    .municipal-drinking-water-plant-operators {
      background: #CCC1DA;
    }

    .wastewater-treatment-plant-operators {
      background: #B3A2C7;
    }

    .residential-property-owners {
      background: #604A7B;
    }

    .military-coast-guard {
      background: #403152;
    }

    .transporters-of-goods {
      background: #D99694;
    }

    .transporters-of-people {
      background: #953735;
    }

    .water-subsisters {
      background: #F9FDD1;
    }

    .food-subsisters {
      background: #F9F383;
    }

    .timber-fiber-fur-hide-subsisters {
      background: #F5F018;
    }

    .building-material-subsisters {
      background: #FFFF00;
    }

    .experiencers-viewers {
      background: #DBEEF4;
    }

    .food-pickers-gatherers {
      background: #B7DEE8;
    }

    .hunters {
      background: #93CDDD;
    }

    .anglers {
      background: #4BACC6;
    }

    .waders-swimmers-divers {
      background: #31859C;
    }

    .boaters {
      background: #215968;
    }

    .spiritual-and-ceremonial-participants {
      background: #C3D69B;
    }

    .artists {
      background: #77933C;
    }

    .students-and-educators {
      background: #FAC090;
    }

    .researchers {
      background: #E46C0A;
    }

    .people-who-care-existence {
      background: #D9D9D9;
    }

    .people-who-care-option-bequest {
      background: #A6A6A6;
    }
      
    .legend {
      border: 1px solid rgba(0, 0, 0, .2);
      display: inline-block;
      height: 1em;
      width: 1em;
    }

    .key {
      border: 1px solid rgba(0, 0, 0, .2);
      display: inline-block;
      height: 1em;
      width: 1em;
      margin: 1em 1em 0 1em;
    }
    
    @media (min-width: 600px) {
      .legend {
        margin: 1em;
      }
    }
    
    .scoring input {
      max-width: 4em;
    }
    
    .dark {
      background: rgba(128, 128, 128, .25);
    }
    
    .light-gray {
      background-color: #f1f1f1;
      border-radius: 3px;
      border: 1px solid rgba(0, 0, 0, .2);
      padding: 1em 1em 1em 1em;
      margin-bottom: .4em;
    }
    
    #stakeholder-list {
      display: none;
      list-style: none;
    }
    
    .stakeholder-value-list {
      list-style: none;
    }
    
    #table-stakeholders td,
    #table-stakeholders th {
      border: 1px solid #d6d7d9;
      padding: 8px;
    }
    
    #stakeholder-table-container {
      display: none;
    }
    
    #table-stakeholders tr:nth-child(even) {
      background-color: #f1f1f1;
    }
    
    #table-stakeholders th {
      background-color: #0071bc;
      color: white;
      padding-top: 12px;
      padding-bottom: 12px;
      text-align: left;
    }
    
    #table-stakeholders {
      border-collapse: collapse;
      width: 100%;
    }
    
    table input {
      text-align: right;
    }
    
    table {
      border-collapse: collapse;
      margin-bottom: 1em;
    }
    
    table th {
      text-align: center;
    }

    table td {
      text-align: center;
    }
    
    table th {
      padding: .5em;
    }
    
    td {
      padding: .3em;
    }
    
    .column-name-labels {
      border-bottom: 1px dashed darkgrey;
    }
    
    .column-names th {
      border-bottom: 1px solid black;
    }
    
    .row-name {
      border-right: 1px solid black;
    }
    
    .invalid-text-input {
      box-shadow: 0 0 5px #e31c3d;
      border: 1px solid #e31c3d;
    }
    
    .display-none {
      display: none;
    }
    
    #menu-title {
      font-weight: bold;
    }
    
    #menu a {
      color: #fff;
      text-decoration: none;
    }
    
    #menu a:hover {
      text-decoration: underline;
    }
    
    #menu ul {
      list-style: none;
      padding-left: 10px;
    }
    
    #menu li {
      margin: 10px;
      padding: 5px;
      border-radius: 2px;
    }
    
    .active {
      font-weight: bold;
    }
    
    .remove-stakeholder {
      background-color: #cd2026;
      color: #fff;
      margin: .25em 0 0 10px;
      padding: 0.25em .5em;
      cursor: pointer;
    }
    
    #show-only-these-columns {
      display: inline;
    }
    
    .progress-menu {
      font-weight: normal;
      font-size: 15px;
    }
    
    #set-stakeholder-values {
      display: none;
    }
    
    #show-name {
      display: inline;
      font-family: "Merriweather", "Georgia", "Cambria", "Times New Roman", "Times", serif;
      font-weight: bold;
      line-height: 1.3;
      margin: 0;
      text-rendering: optimizeLegibility;
    }

    .wrapper {
      background-color: #e4e2e0;
      position: relative;
    }

    .wrapper > .inner {
      max-width: 100%;
      padding: 2.5em 2.5em 1.5em 2.5em;
      width: 75em;
    }

    #sidebar {
      padding: 2.5em 1.5em 0.5em 1.5em;
      background: #494440;
      color: #fff;
      cursor: default;
      height: 100vh;
      left: 0;
      overflow-x: hidden;
      overflow-y: auto;
      position: fixed;
      text-align: right;
      top: 0;
      width: 15em;
      z-index: 10000;
    }

    #sidebar > .inner {
      display: flex;
      flex-direction: column;
      justify-content: center;
      transform: translateY(0);
      transition: opacity 1s ease;
      min-height: 100%;
      opacity: 1;
      width: 100%;
    }

    #sidebar + #wrapper {
      margin-left: 15em;
    }

    #sidebar::-webkit-scrollbar { 
      display: none; 
    }

    .pie {
      align-self: center;
      margin: 0 4em 0 4em;
    }

    #stakeholder-barchart {
      align-self: center;
    }

    .flex-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }

    table input {
      width: calc(100% - 2em);
      text-align: right;
      margin: .5em 1em;
      padding: .2em;
    }

    .scoring [data-th="Color"] {
      padding: 0;
    }

    .accessible-notification {
      background-color: #fdb81e;
      bottom: 0;
      padding: .5em;
      position: fixed;
      z-index: 10001;
    }
    .inline-block {
      display: inline-block;
    }

    .stakeholder-score-input {
      margin: 0 0 .25em .25em;
    }

    #table-stakeholders button {
      margin: 0 0 .5em;
    }

    #add-stakeholder {
      margin: 0;
    }

    .d3-tip {
      line-height: 1;
      padding: 12px;
      background: rgba(0, 0, 0, 0.8);
      color: #fff;
      border-radius: 2px;
      pointer-events: none;
    }
  </style>
</head>

<body>
  <section id="sidebar">
    <h2 id="menu-title">FEGS Scoping Tool</h2>
    <div id="menu" class="inner">
      Project name: <a href="#" onclick="fegsScopingView.editName()" id="show-name" title="Change project name"><span id="menu-project-name"></span><span id="unsaved-indicator" hidden>*</span></a>
      <input class="form-text" id="input-name" type="text" hidden>
      <button onclick="fegsScopingController.updateName(document.getElementById('input-name').value)" id="save-name" hidden>Save this name</button>
      <nav>
        <ul>
          <li>
            <a href="#section-weighting">Weights</a>
            <div id="weighting-progress" class="progress-menu"></div>
          </li>
          <li>
            <a href="#section-stakeholders">Stakeholders</a>
            <div id="stakeholder-progress" class="progress-menu"></div>
          </li>
          <li>
            <a href="#section-beneficiaries">Beneficiaries</a>
            <div id="beneficiaries-progress" class="progress-menu"></div>
          </li>
          <li>
            <a href="#section-attributes">Attributes</a>
            <div id="attributes-progress" class="progress-menu"></div>
          </li>
        </ul>
      </nav>
      <span id="zoomer" hidden>Zoom: <span id="page-zoom-indicator">100%</span> <input id="page-zoom" max="2" min="0.25" onchange="pageZoomChange(event)" oninput="indicatePageZoom(event)" step="0.01" type="range" value="1.0"></span>
    </div>
    <button onclick="window.location.reload()">Dev Feature: Reload application</button>
  </section>

  <div id="wrapper">
    <section class="wrapper">
      <div id="main-content" class="inner">
        <div class="page" id="section-weighting">
          <h2>Weights</h2>
          <p>Look over the criteria below. Identify the criterion that you value the most. Give that criterion a weight of 100. Weight all other criteria relative to that most valued criterion.</p>
          <div id="scoring-inputs" class="flex-container">
            <div>
              <table class="scoring" id="table-scores">
                <thead>
                  <tr>
                    <th>Color</th>
                    <th>Label</th>
                    <th>Value</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th data-th="Color"><span class="legend magnitude"></span></th>
                    <th data-th="Label">Magnitude & Probability of impact</th>
                    <td data-th="Value"><input id="magnitude-score" type="number" /></td>
                  </tr>
                  <tr>
                    <th data-th="Color"><span class="legend influence"></span></th>
                    <th data-th="Label">Level of influence</th>
                    <td data-th="Value"><input id="influence-score" type="number" /></td>
                  </tr>
                  <tr>
                    <th data-th="Color"><span class="legend interest"></span></th>
                    <th data-th="Label">Level of interest</th>
                    <td data-th="Value"><input id="interest-score" type="number" /></td>
                  </tr>
                  <tr>
                    <th data-th="Color"><span class="legend urgency"></span></th>
                    <th data-th="Label">Urgency & Temporal immediacy</th>
                    <td data-th="Value"><input id="urgency-score" type="number" /></td>
                  </tr>
                  <tr>
                    <th data-th="Color"><span class="legend proximity"></span></th>
                    <th data-th="Label">Proximity</th>
                    <td data-th="Value"><input id="proximity-score" type="number" /></td>
                  </tr>
                  <tr>
                    <th data-th="Color"><span class="legend economic-interest"></span></th>
                    <th data-th="Label">Economic interest</th>
                    <td data-th="Value"><input id="economic-interest-score" type="number" /></td>
                  </tr>
                  <tr>
                    <th data-th="Color"><span class="legend rights"></span></th>
                    <th data-th="Label">Rights</th>
                    <td data-th="Value"><input id="rights-score" type="number" /></td>
                  </tr>
                  <tr>
                    <th data-th="Color"><span class="legend fairness"></span></th>
                    <th data-th="Label">Fairness</th>
                    <td data-th="Value"><input id="fairness-score" type="number" /></td>
                  </tr>
                  <tr>
                    <th data-th="Color"><span class="legend representation"></span></th>
                    <th data-th="Label">Underrepresented & Underserved representation</th>
                    <td data-th="Value"><input id="representation-score" type="number" /></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="criteria-pie" class="criteria-pie" hidden></div>
          </div>
        </div>
        <hr />
        <div class="page" id="section-stakeholders">
          <h2>Stakeholders</h2>
          <p>Identify your stakeholder-groups.</p>
          <div id="stakeholder-prioritization">
            <div>
              <div class="light-gray">
                <label class="inline-block">Stakeholder-group name <input class="form-text" type="text" id="stakeholder-group"/></label>
                <button id="add-stakeholder" onclick="addStakeholder();">Add stakeholder-group</button>
                <ul id="stakeholder-list"></ul>
              </div>
            </div>
            <br />
            <br />
            <div id="set-stakeholder-values">
              <h3>Score Stakeholders</h3>
              <p>Score each stakeholder-group for each of the 9 criteria.</p>
              <div>
                <div class="light-gray">
                  <h4>Magnitude & Probability of impact</h4>
                  <p>If changes are made in this decision context what is the likelihood that this stakeholder group will be impacted? What is the potential magnitude of that impact?</p>
                  <p>Please enter a number 0 to 100.</p>
                  <ul data-criterion="magnitude" class="stakeholder-value-list"></ul>
                  <img src="img/probabilitymagnitude.PNG" width="250" alt="Probability and magnitude matrix">
                </div>
              </div>
              <div>
                <div class="light-gray">
                  <h4>Level of influence</h4>
                  <p>Does this stakeholder-group have any formal or informal influence over the decision making process?</p>
                  <p>Please enter a number 0 to 100.</p>
                  <ul>
                    <li>100 = This group has formal influence over the decision-making process (i.e. can have the project stopped, must be consulted with).</li>
                    <li>50 = This group has informal influence over the decision-making process.</li>
                    <li>0 = This group has no influence over the decision-making process.</li>
                  </ul>
                  <ul data-criterion="influence" class="stakeholder-value-list"></ul>
                </div>
              </div>
              <div>
                <div class="light-gray">
                  <h4>Level of interest</h4>
                  <p>What is this stakeholder-group's level of interest in this decision/action?</p>
                  <p>Please enter a number 0 to 100.</p>
                  <ul>
                    <li>100 = High.</li>
                    <li>75 = Moderate.</li>
                    <li>50 = Low.</li>
                    <li>0 = None.</li>
                  </ul>
                  <ul data-criterion="interest" class="stakeholder-value-list"></ul>
                </div>
              </div>
              <div>
                <div class="light-gray">
                  <h4>Urgency & Temporal immediacy</h4>
                  <p>Does this stakeholder-group want an immediate decision/action on this issue?</p>
                  <ul>
                    <li>100 = Yes, even if other actions/decisions must be postponed.</li>
                    <li>80 = Yes, as long as it does not delay current commitments.</li>
                    <li>60 = They would like to see action/a decision within a relatively short timeframe.</li>
                    <li>40 = They would like to see action/a decision within a medium range timeframe.</li>
                    <li>20 = They would like to see action/a decision made, but have no timeframe for it.</li>
                    <li>0 = They do not care when an action/decision takes place.</li>
                  </ul>
                  <ul data-criterion="urgency" class="stakeholder-value-list"></ul>
                </div>
              </div>
              <div>
                <div class="light-gray">
                  <h4>Proximity</h4>
                  <p>How frequently does this stakeholder-group come into contact with the area subject to this decision?</p>
                  <ul>
                    <li>100 = They are constantly in direct contact with the area.</li>
                    <li>75 = They are constantly in contact with areas adjacent to the area OR They are frequently in direct contact with the area.</li>
                    <li>50 = They are frequently in contact with areas adjacent to the area OR They are infrequently in direct contact with the area.</li>
                    <li>25 = They are infrequently in contact with areas adjacent to the area.</li>
                    <li>10 = They interact with this area from a distance.</li>
                    <li>0 = They are never in contact with the area.</li>
                  </ul>
                  <ul data-criterion="proximity" class="stakeholder-value-list"></ul>
                </div>
              </div>
              <div>
                <div class="light-gray">
                  <h4>Economic interest</h4>
                  <p>Does this stakeholder-group have an economic interest in the outcome of this decision?</p>
                  <ul>
                    <li>100 = Yes.</li>
                    <li>0 = No.</li>
                  </ul>
                  <ul data-criterion="economic-interest" class="stakeholder-value-list"></ul>
                </div>
              </div>
              <div>
                <div class="light-gray">
                  <h4>Rights</h4>
                  <p>Does this stakeholder-group have any 1) legal right to be involved in this decision making process, 2) property rights associated with the land that will be impacted by the decision, or 3) consumer/user rights associated with the services
                    that will be impacted by the decision?</p>
                  <ul>
                    <li>100 = Yes, all 3.</li>
                    <li>60 = Yes, 2 of the 3.</li>
                    <li>20 = Yes, 1 of the 3.</li>
                    <li>0 = No.</li>
                  </ul>
                  <ul data-criterion="rights" class="stakeholder-value-list"></ul>
                </div>
              </div>
              <div>
                <div class="light-gray">
                  <h4>Fairness</h4>
                  <p>If this stakeholder-group is not considered in decision-making, would the resulting decision be seen as unfair?</p>
                  <ul>
                    <li>100 = Yes.</li>
                    <li>0 = No.</li>
                  </ul>
                  <ul data-criterion="fairness" class="stakeholder-value-list"></ul>
                </div>
              </div>
              <div>
                <div class="light-gray">
                  <h4>Underrepresented & Underserved representation</h4>
                  <p>Does this stakeholder-group represent underserved or underrepresented groups?</p>
                  <ul>
                    <li>100 = Yes.</li>
                    <li>0 = No.</li>
                  </ul>
                  <ul data-criterion="representation" class="stakeholder-value-list"></ul>
                </div>
              </div>
              <button onclick="addStakeholderScores();">Add stakeholder scores</button>
            </div>
          </div>
          <div id="stakeholder-table-container">
            <h3>Stakeholders</h3>
            <table id="table-stakeholders">
              <thead>
                <tr>
                  <th></th>
                  <th>Stakeholder-group</th>
                  <th>Magnitude & Probability of impact</th>
                  <th>Level of influence</th>
                  <th>Level of interest</th>
                  <th>Urgency & Temporal immediacy</th>
                  <th>Proximity</th>
                  <th>Economic interest</th>
                  <th>Rights</th>
                  <th>Fairness</th>
                  <th>Underrepresented & Underserved representation</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
            <h4>Stakeholder Prioritization</h4>
            <div class="flex-container light-gray">
              <div id="stakeholder-barchart"></div>
              <div class="criteria-pie"></div>
            </div>
            <div class="flex-container light-gray">
              <div>
                <span class="key magnitude"></span>
                <span>Magnitude & Probability of impact</span>
              </div>
              <div>
                <span class="key influence"></span>
                <span>Level of influence</span>
              </div>
              <div>
                <span class="key interest"></span>
                <span>Level of interest</span>
              </div>
              <div>
                <span class="key urgency"></span>
                <span>Urgency & Temporal immediacy</span>
              </div>
              <div>
                <span class="key proximity"></span>
                <span>Proximity</span>
              </div>
              <div>
                <span class="key economic-interest"></span>
                <span>Economic interest</span>
              </div>
              <div>
                <span class="key rights"></span>
                <span>Rights</span>
              </div>
              <div>
                <span class="key fairness"></span>
                <span>Fairness</span>
              </div>
              <div>
                <span class="key representation"></span>
                <span>Underrepresented & Underserved representation</span>
              </div>
          </div>
          </div>
        </div>
        <hr />
        <div class="page" id="section-beneficiaries">
          <h2>Beneficiaries</h2>

          <label for="select-stakeholder">Identify the types of beneficiaries making up each stakeholder-group by percentage.</label>
          <select class="form-select" id="select-stakeholder" onchange="selectStakeholderToSlice()">
            <option selected="selected" disabled="disabled">Select a Stakeholder-Group</option>
          </select>

          <table id="table-beneficiaries">
            <thead>
              <tr>
                <th style="width: 10em;">Category</th>
                <th style="width: 10em;">Subcategory <br /><a id="table-beneficiaries-toggle" href="#" onclick="toggleTableDefinitions(event, 'table-beneficiaries'); return false;">Hide definitions</a></th>
                <th style="width: 15em;" class="definition">Definition</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="agricultural" rowspan="7">Agricultural</th>
                <th class="agricultural">Irrigators</th>
                <td class="definition">Irrigator, irrigation, watering</td>
              </tr>
              <tr>
                <th class="agricultural">CAFO Operators</th>
                <td class="definition">CAFO; feeding operations or feed lots for livestock (cattle, hogs, or poultry), livestock production</td>
              </tr>
              <tr>
                <th class="agricultural">Livestock grazers</th>
                <td class="definition">Ranches or grazing for livestock (cattle, hogs, or poultry), cattle range</td>
              </tr>
              <tr>
                <th class="agricultural">Agricultural processors</th>
                <td class="definition">Agricultural or farm processors or processing; agricultural or farm production or products (but not seafood)</td>
              </tr>
              <tr>
                <th class="agricultural">Aquaculturalists</th>
                <td class="definition">Aquaculture or aquafarming; farms or hatcheries for shellfish, fish, oysters, clams, mussels, shrimp, or aquatic plants</td>
              </tr>
              <tr>
                <th class="agricultural">Farmers</th>
                <td class="definition">Farmer, farming, farm (but not aquaculture); plantation, crops, orchards</td>
              </tr>
              <tr>
                <th class="agricultural">Foresters</th>
                <td class="definition">Forester or forestry; tree farm; silviculture</td>
              </tr>
              <tr>
                <th class="commercial" rowspan="8">Commercial / Industrial</th>
                <th class="commercial">Food extractors</th>
                <td class="definition">Food extraction; hunting or trapping for livelihood, job, or commercial purpose; commercial or artisanal fishing, shrimping, clamming</td>
              </tr>
              <tr>
                <th class="commercial">Timber / Fiber / Ornamental extractors</th>
                <td class="definition">Timber, fiber, wood, or ornament extraction or harvest for commercial or business purposes; logging or logger; oyster harvest, abalone collecting</td>
              </tr>
              <tr>
                <th class="commercial">Industrial processors</th>
                <td class="definition">Industrial processing or production; manufacturing; textile, steel, or industries or production; mills; oil and gas industry (including extraction & processing); mining; food (meat, sugar, grain, vegetable, fruit) processing</td>
              </tr>
              <tr>
                <th class="commercial">Industrial dischargers</th>
                <td class="definition">Industrial discharge or wastewater</td>
              </tr>
              <tr>
                <th class="commercial">Energy generators</th>
                <td class="definition">Power plant, electric, hydroelectric; solar, wind, hydro, renewable, nuclear power or energy; thermoelectric cooling</td>
              </tr>
              <tr>
                <th class="commercial">Resource dependent businesses</th>
                <td class="definition">Businesses that rely or depend on local resources; marina, tourism, resort, hotel, shop, restaurant, local business, developed or working waterfronts; outfitter, fishing/hunting guide; fishing charter, tour boats</td>
              </tr>
              <tr>
                <th class="commercial">Pharmaceutical / Food supplement suppliers</th>
                <td class="definition">Pharmaceuticals, medicines; food supplements, vitamins</td>
              </tr>
              <tr>
                <th class="commercial">Fur / Hide trappers / hunters</th>
                <td class="definition">Hunting or trapping for animal skin, hide, fur</td>
              </tr>
              <tr>
                <th class="governmental" rowspan="4">Governmental / Municipal / Residential</th>
                <th class="governmental">Municipal drinking water plant operators</th>
                <td class="definition">Drinking water, municipal water supply</td>
              </tr>
              <tr>
                <th class="governmental">Wastewater treatment plant operators</th>
                <td class="definition">Wastewater or sewage treatment; treatment plant</td>
              </tr>
              <tr>
                <th class="governmental">Residential property owners</th>
                <td class="definition">Homeowners, private land or property, landowner; Residential areas, neighborhoods, or development</td>
              </tr>
              <tr>
                <th class="governmental">Military / Coast Guard</th>
                <td class="definition">Military, coast guard, navy, army, shipyard</td>
              </tr>
              <tr>
                <th class="transportation" rowspan="2">Commercial / Military Transportation</th>
                <th class="transportation">Transporters of goods</th>
                <td class="definition">Goods transport, shipping, cargo, commercial navigation, port, vessel, barge, freight, bulk commodities, containers</td>
              </tr>
              <tr>
                <th class="transportation">Transporters of people</th>
                <td class="definition">People transport, cruise, ferry, ferries, airplane, airport, train, harbor</td>
              </tr>
              <tr>
                <th class="subsistence" rowspan="4">Subsistence</th>
                <th class="subsistence">Water subsisters</th>
                <td class="definition">Cistern, rain garden, rain barrel; water for subsistence, including tribal or traditional use</td>
              </tr>
              <tr>
                <th class="subsistence">Food subsisters</th>
                <td class="definition">Food for subsistence; hunting, fishing, collecting, or gathering food to cook or eat; digging shellfish or clams; including tribal or traditional use, wild rice</td>
              </tr>
              <tr>
                <th class="subsistence">Timber / Fiber / Fur / Hide subsisters</th>
                <td class="definition">Collect timber, fiber, fur, or hides for subsistence, including tribal or cultural traditions; firewood</td>
              </tr>
              <tr>
                <th class="subsistence">Building material subsisters</th>
                <td class="definition">Collecting building materials for subsistence, including tribes or cultural traditions</td>
              </tr>
              <tr>
                <th class="recreational" rowspan="6">Recreational</th>
                <th class="recreational">Experiencers / viewers</th>
                <td class="definition">Bird, wildlife, or fauna watching; nature appreciation; hiking, biking, camping, climbing, outings, sunbathing, sightseeing, beach combing; viewing (i.e. observing, enjoying, experiencing, relaxing, outings) nature (e.g. outdoors, wildlife, wildflowers, animals, trails)</td>
              </tr>
              <tr>
                <th class="recreational">Food pickers / gatherers</th>
                <td class="definition">Collect or gather berries, mushrooms; dig for shellfish or clams; wild rice</td>
              </tr>
              <tr>
                <th class="recreational">Hunters</th>
                <td class="definition">Hunting for recreation or sport</td>
              </tr>
              <tr>
                <th class="recreational">Anglers</th>
                <td class="definition">Anglers, fishing for recreation or sport</td>
              </tr>
              <tr>
                <th class="recreational">Waders / Swimmers / Divers</th>
                <td class="definition">Snorkeling, SCUBA, swimming, beachgoing, wading, diving, bathing</td>
              </tr>
              <tr>
                <th class="recreational">Boaters</th>
                <td class="definition">Boat, canoe, kayak, rowing, sailing, jet ski, surfing, watercraft</td>
              </tr>
              <tr>
                <th class="inspirational" rowspan="2">Inspirational</th>
                <th class="inspirational">Spiritual and ceremonial participants</th>
                <td class="definition">Festival, observance, religion, ceremony, baptism, wedding, spiritual, worship, prayer</td>
              </tr>
              <tr>
                <th class="inspirational">Artists</th>
                <td class="definition">Writer, author, poet, painter, artist, sculptor, carver, pottery, photography</td>
              </tr>
              <tr>
                <th class="learning" rowspan="2">Learning</th>
                <th class="learning">Students and educators</th>
                <td class="definition">Educational use, resource, interest, or opportunity; academic, teaching, professor, student; secondary schools (elementary, middle, high); school children; field trips or outdoor laboratories</td>
              </tr>
              <tr>
                <th class="learning">Researchers</th>
                <td class="definition">Opportunities or interest for significant scientific research and improving scientific knowledge, investigation, research, questions</td>
              </tr>
              <tr>
                <th class="nonuse" rowspan="2">Non-Use</th>
                <th class="nonuse">People who care (existence)</th>
                <td class="definition">Caring, concern, conservation, or appreciation by the community (citizens, stakeholders, people, residents, anyone, everyone, children, families); Existence value; History; Culture</td>
              </tr>
              <tr>
                <th class="nonuse">People who care (option, bequest)</th>
                <td class="definition">Bequest, option, legacy, or heritage value; future or next generation (grandchildren)</td>
              </tr>
            </tbody>
          </table>
          <div id="beneficiary-charts" hidden>
            <div class="flex-container light-gray">
              <div id="beneficiary-barchart"></div>
              <div class="beneficiary-pie" style="align-self: center; margin: 0 4em 0 4em;"></div>
            </div>
            <div class="flex-container light-gray">
              <div><span class="key irrigators"></span><span>Irrigators</span></div>
              <div><span class="key cafo-operators"></span><span>CAFO Operators</span></div>
              <div><span class="key livestock-grazers"></span><span>Livestock grazers</span></div>
              <div><span class="key agricultural-processors"></span><span>Agricultural processors</span></div>
              <div><span class="key aquaculturalists"></span><span>Aquaculturalists</span></div>
              <div><span class="key farmers"></span><span>Farmers</span></div>
              <div><span class="key foresters"></span><span>Foresters</span></div>
              <div><span class="key food-extractors"></span><span>Food extractors</span></div>
              <div><span class="key timber-fiber-ornamental-extractors"></span><span>Timber / Fiber / Ornamental extractors</span></div>
              <div><span class="key industrial-processors"></span><span>Industrial processors</span></div>
              <div><span class="key industrial-dischargers"></span><span>Industrial dischargers</span></div>
              <div><span class="key energy-generators"></span><span>Energy generators</span></div>
              <div><span class="key resource-dependent-businesses"></span><span>Resource dependent businesses</span></div>
              <div><span class="key pharmaceutical-food-supplement-suppliers"></span><span>Pharmaceutical / Food supplement suppliers</span></div>
              <div><span class="key fur-hide-trappers-hunters"></span><span>Fur / Hide trappers / hunters</span></div>
              <div><span class="key municipal-drinking-water-plant-operators"></span><span>Municipal drinking water plant operators</span></div>
              <div><span class="key wastewater-treatment-plant-operators"></span><span>Wastewater treatment plant operators</span></div>
              <div><span class="key residential-property-owners"></span><span>Residential property owners</span></div>
              <div><span class="key military-coast-guard"></span><span>Military / Coast Guard</span></div>
              <div><span class="key transporters-of-goods"></span><span>Transporters of goods</span></div>
              <div><span class="key transporters-of-people"></span><span>Transporters of people</span></div>
              <div><span class="key water-subsisters"></span><span>Water subsisters</span></div>
              <div><span class="key food-subsisters"></span><span>Food subsisters</span></div>
              <div><span class="key timber-fiber-fur-hide-subsisters"></span><span>Timber / Fiber / Fur / Hide subsisters</span></div>
              <div><span class="key building-material-subsisters"></span><span>Building material subsisters</span></div>
              <div><span class="key experiencers-viewers"></span><span>Experiencers / viewers</span></div>
              <div><span class="key food-pickers-gatherers"></span><span>Food pickers / gatherers</span></div>
              <div><span class="key hunters"></span><span>Hunters</span></div>
              <div><span class="key anglers"></span><span>Anglers</span></div>
              <div><span class="key waders-swimmers-divers"></span><span>Waders / Swimmers / Divers</span></div>
              <div><span class="key boaters"></span><span>Boaters</span></div>
              <div><span class="key spiritual-and-ceremonial-participants"></span><span>Spiritual and ceremonial participants</span></div>
              <div><span class="key artists"></span><span>Artists</span></div>
              <div><span class="key students-and-educators"></span><span>Students and educators</span></div>
              <div><span class="key researchers"></span><span>Researchers</span></div>
              <div><span class="key people-who-care-existence"></span><span>People who care (existence)</span></div>
              <div><span class="key people-who-care-option-bequest"></span><span>People who care (option, bequest)</span></div>
          </div>
        </div>
        <hr />
        <div class="page" id="section-attributes">
          <h2>Attributes</h2>
          <h3 id="table-attributes-header">Score Attributes for each Beneficiary</h3>

          <table id="table-attributes">
            <colgroup>
              <col class="row-labels" span="2" />
              <col class="definition" span="1" />
              <col class="agricultural" span="7" />
              <col class="commercial" span="8" />
              <col class="governmental" span="4" />
              <col class="transportation" span="2" />
              <col class="subsistence" span="4" />
              <col class="recreational" span="6" />
              <col class="inspirational" span="2" />
              <col class="learning" span="2" />
              <col class="nonuse" span="2" />
            </colgroup>
            <thead>
              <tr class="column-name-labels">
                <th colspan="2" class="row-label-header"></th>
                <th colspan="1" rowspan="3" class="definition">Definition</th>
                <th colspan="7">Agricultural</th>
                <th colspan="8">Commercial/ Industrial</th>
                <th colspan="4">Governmental/Municipal/Residential</th>
                <th colspan="2">Commercial/ Military Transportation</th>
                <th colspan="4">Subsistence</th>
                <th colspan="6">Recreational</th>
                <th colspan="2">Inspirational</th>
                <th colspan="2">Learning</th>
                <th colspan="2">Non-Use</th>
              </tr>
              <tr class="column-names">
                <th colspan="2"></th>
                <th aria-hidden="true"></th>
                <th aria-hidden="true"></th>
                <th>Irrigators</th>
                <th>CAFO Operators</th>
                <th>Livestock grazers</th>
                <th>Agricultural processors</th>
                <th>Aquaculturalists</th>
                <th>Farmers</th>
                <th>Foresters</th>
                <th>Food extractors</th>
                <th>Timber / Fiber / Ornamental extractors</th>
                <th>Industrial processors</th>
                <th>Industrial dischargers</th>
                <th>Energy generators</th>
                <th>Resource dependent businesses</th>
                <th>Pharmaceutical / Food supplement suppliers</th>
                <th>Fur / Hide trappers / hunters</th>
                <th>Municipal drinking water plant operators</th>
                <th>Wastewater treatment plant operators</th>
                <th>Residential property owners</th>
                <th>Military / Coast Guard</th>
                <th>Transporters of goods</th>
                <th>Transporters of people</th>
                <th>Water subsisters</th>
                <th>Food subsisters</th>
                <th>Timber / Fiber / Fur / Hide subsisters</th>
                <th>Building material subsisters</th>
                <th>Experiencers / viewers</th>
                <th>Food pickers / gatherers</th>
                <th>Hunters</th>
                <th>Anglers</th>
                <th>Waders / Swimmers / Divers</th>
                <th>Boaters</th>
                <th>Spiritual and ceremonial participants</th>
                <th>Artists</th>
                <th>Students and educators</th>
                <th>Researchers</th>
                <th>People who care (existence)</th>
                <th>People who care (option, bequest)</th>
              </tr>
              <tr class>
                <th class="row-tier-1" aria-hidden="true"></th>
                <th colspan="2" class="row-name">
                  Beneficiary Score <br />
                  <a id="table-attributes-toggle" href="#" onclick="toggleTableDefinitions(event, 'table-attributes'); return false;">Show definitions</a>
                </th>
                <th aria-hidden="true" colspan="1"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </thead>
            <tbody>
              <tr class="dark">
                <th rowspan="3" class="row-tier-1">Water</th>
                <th class="row-name">Water quality</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Water quantity</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Water movement</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th rowspan="3" class="row-tier-1">Land</th>
                <th class="row-name">Land quantity</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Land quality</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Land availability</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th rowspan="5" class="row-tier-1">Atmosphere</th>
                <th class="row-name">Wind strength / speed</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Wind predictability / consistency</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Air quality</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Weather predictability</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Frequency of extreme weather events</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th rowspan="8" class="row-tier-1">Natural materials</th>
                <th class="row-name">Soil availability</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Soil quality</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Substrate quantity</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Substrate quality</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Fuel quantity</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Availability of fiber materials for use or subsistence</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Availability of minerals / chemicals</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Availability of other natural materials for artistic use or consumption (e.g. shells, clay, acorns, honey)</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th rowspan="9" class="row-tier-1">Flora / fungi</th>
                <th class="row-name">Flora community</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Edible flora / fungi</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Medicinal flora / fungi</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Structural flora / fungi</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Charismatic flora / fungi</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Aesthetic flora / fungi</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Rare flora / fungi</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Commercially important flora / fungi</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Spiritually / culturally important flora / fungi</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th rowspan="11" class="row-tier-1">Fauna</th>
                <th class="row-name">Fauna community</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Edible fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Medicinal fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Keystone fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Charismatic fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Aesthetic fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Rare fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Pollinating fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Pest / predator / depredator fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Commercially important fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th aria-hidden="true"></th>
                <th class="row-name">Spiritually / culturally important fauna</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th rowspan="4" class="row-tier-1">Environmental aesthetics</th>
                <th class="row-name">Sounds</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Scents</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Scents</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class="dark">
                <th aria-hidden="true"></th>
                <th class="row-name">Phenomena (e.g. sunsets, northern lights, etc)</th>
                <th class="definition"></th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
          </table>
          <div id="attribute-charts">
          <div class="flex-container light-gray">
            <div id="attribute-barchart"></div>
            <div class="attribute-pie" style="align-self: center; margin: 0 4em 0 4em;"></div>
          </div>
        </div>
      </div>
      </div>
    </section>
  </div>
  <script>
    window.addEventListener("scroll", onScroll);

    function onScroll(event) {
      var scrollPos = window.scrollY;
      var menuItems = document.querySelectorAll('#menu > nav a');
      for (var i = 0; i < menuItems.length; i++) {
        var currentItem = menuItems[i];
        var hrefElement = document.getElementById(currentItem.getAttribute('href').replace('#', ''));
        if (hrefElement.offsetTop <= (scrollPos + 1) && hrefElement.offsetTop + hrefElement.offsetHeight > scrollPos) {
          currentItem.parentNode.classList.add("active");
        } else {
          currentItem.parentNode.classList.remove("active");
        }
      }
    }
    var getDocument = function() {
      var documentText = '<!DOCTYPE html>' + '\n' + document.documentElement.outerHTML;
      return documentText;
    }

    var downloadText = function(filename, text) {
      var element = document.createElement('a');
      element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
      element.setAttribute('download', filename);

      element.style.display = 'none';
      document.body.appendChild(element);

      element.click();

      document.body.removeChild(element);
    }
  </script>
  <!-- FIXME: integrate code between comment flags into application -->
  <script src="./js/d3.v5.min.js"></script>
  <script src="./js/d3.tip.js"></script>

  <script>
    /** Prototype data-model and its CRUD-methods. */
    var FEGSScopingData = function() {

      /**
       * This object-factory sets value as specified in arg criteria
       *  else to defaultValue.
       *
       * @param {string|Object.<string, string>} values - a single
       *  string to use as a value for all criteria or an object
       *  specifying each value as a numerical string indexed by
       *  its criterion
       */
      this.makeCriteriaObject = function(values) {
        var valuesObject = {};
        var defaultValue = '';
        var i;
        var valuesCriteria;
        if (typeof(values) === 'string') {
          for (i = 0; i < this.criteria.length; i++) {
            valuesObject[this.criteria[i]] = values;
          }
          return valuesObject;
        } else if (typeof(values) === 'object') {
          if (values.length) {
            throw 'Argument values should be an object or a string but values is neither.';
          }
          valuesCriteria = Object.keys(values);
          for (i = 0; i < valuesCriteria.length; i++) {
            if (String(this.criteria.indexOf(String(valuesCriteria[i]))) === '-1') {
              throw 'An unkown criterion was supplied as a key: ' + valuesCriteria[i];
            }
            valuesObject[valuesCriteria[i]] = values[valuesCriteria[i]];
          }
          for (i = 0; i < this.criteria.length; i++) {
            if (valuesCriteria.indexOf(this.criteria[i]) === -1) {
              valuesObject[this.criteria[i]] = defaultValue;
            }
          }
          return valuesObject;
        } else {
          throw 'expected values to be an object or a string but was neither';
        }
      };

      /**
       * add a stakeholder and its criteria-scores
       * @param {string} stakeholderName - name of stakeholder to add
       * @param {Object <string>.<string>} stakeholderScores -
       *  criteria are keys and respective scores for this
       *  stakeholder are values
       */
      this.addStakeholder = function(stakeholderName, stakeholderScores) {
        this.stakeholders[stakeholderName] = {
          scores: stakeholderScores,
          beneficiaries: {}
        };
      };

      /**
       * rename oldStakeholderName to newStakeholderName
       * @param {string} oldStakeholderName - current name of the stakeholder
       * @param {string} newStakeholderName - new name of the stakeholder
       */
      this.renameStakeholder = function(oldStakeholderName, newStakeholderName) {
        this.stakeholders[newStakeholderName] = this.stakeholders[oldStakeholderName];
        this.removeStakeholders([oldStakeholderName]);
      };

      /**
       * add a beneficiary and its percentage of its stakeholder
       * @param {string} stakeholderName - owner of beneficiary
       */
      this.addBeneficiary = function(stakeholderName, beneficiaryName, percentageOfStakeholder) {
        if (typeof(percentageOfStakeholder) === 'undefined') { // validate argument percentageOfStakeholder
          percentageOfStakeholder = '';
        }
        this.stakeholders[stakeholderName]
          .beneficiaries[beneficiaryName] = {
            'percentageOfStakeholder': percentageOfStakeholder
          };
      };

      /**
       * add attributes to this.attributes
       * @param {string} beneficiaryName - owner of attributes
       * @param {Object <string>.<string>} attributes - keys are
       *  attribute-names and values are percentages of the
       *  corresponding attributes' owning beneficiary
       */
      this.addAttributes = function(beneficiaryName, attributes) {
        if (typeof(this.attributes) === 'undefined') {
          this.attributes = {};
        }
        this.attributes[beneficiaryName] = {};
        var keys = Object.keys(attributes)
        for (i = 0; i < keys.length; i++) {
          this.attributes[beneficiaryName][keys[i]] = {
            percentageOfBeneficiary: attributes[keys[i]]
          };
        }
      };

      this.clearOtherAttributes = function(beneficiaries) {
        for (var i = 0; i < fegsScopingData.fegsBeneficiaries.length; i++) {
          if (beneficiaries.indexOf(fegsScopingData.fegsBeneficiaries[i]) < 0) {
            for (var attribute in fegsScopingData.attributes[fegsScopingData.fegsBeneficiaries[i]]) {
              fegsScopingData.attributes[fegsScopingData.fegsBeneficiaries[i]][attribute].percentageOfBeneficiary = '';
            }
          }
        }
      };

      /**
       * remove stakeholders named in an array
       * @param {Array.<string>} stakeholdersArray - names of
       *  stakeholders to be removed
       */
      this.removeStakeholders = function(stakeholdersArray) {
        for (var i = 0; i < stakeholdersArray.length; i++) {
          delete(this.stakeholders[stakeholdersArray[i]]);
        }
      };

      /**
       * remove beneficiaries named in an object of arrays
       *  where each key is a stakeholder's name and the
       *  corresponding array's elements are the
       *  beneficiaries owned by that stakeholder who are
       *  to be removed
       * @param {Object.<string,Array.<string>>} beneficiariesObject -
       *  beneficiaries to be removed specified as an object like
       *  {stakeholderName: [beneficiaryName]}
       */
      this.removeBeneficiariesFromStakeholder = function(beneficiariesObject) {
        var stakeholdersArray = Object.keys(beneficiariesObject);
        for (var i = 0; i < stakeholdersArray.length; i++) {
          var beneficiariesArray = beneficiariesObject[stakeholdersArray[i]];
          for (var j = 0; j < beneficiariesArray.length; j++) {
            delete(this.stakeholders[stakeholdersArray[i]]
              .beneficiaries[beneficiariesArray[j]]);
          }
        }
      };

      /**
       * completely remove beneficiaries named in an array:
       *  remove listed beneficiaries from all stakeholders
       *  and from the keys of this.attributes
       * @param {Array.<string>} beneficiariesArray -
       *  beneficiaries to be removed specified as an object like
       *  [beneficiaryName]
       */
      this.removeBeneficiariesCompletely = function(beneficiariesArray) {
        var stakeholdersArray = Object.keys(this.stakeholders);
        for (var i = 0; i < stakeholdersArray.length; i++) {
          for (var j = 0; j < beneficiariesArray.length; j++) {
            delete(this.stakeholders[stakeholdersArray[i]]
              .beneficiaries[beneficiariesArray[j]]);
            delete(this.attributes[beneficiariesArray[j]]);
          }
        }
      };

      /**
       * remove attributes named in an array
       * @param {Array.<string>} attributesArray -
       *  attributes to be removed specified like
       *  [attributeName]
       */
      this.removeAttributesCompletely = function(attributesArray) {
        var beneficiariesArray = Object.keys(this.attributes);
        for (var j = 0; j < beneficiariesArray.length; j++) {
          for (var k = 0; k < attributesArray.length; k++) {
            delete(this.attributes[benficiariesArray[k]][attributesArray[k]]);
          }
        }
      };

      /** assign properties of valuesObject to this */
      this.add = function(valuesObject) {
        Object.assign(this, valuesObject);
      };

      /**
       * sum percentageOfStakeholder for all optionally specified
       *  beneficiaries for each optionally specified stakeholder;
       *  if no stakeholders are specified then sum over all;
       *  if no beneficiaries are specified then sum over all;
       * @param {Array.<string>} stakeholderNames - names of
       *  stakeholders over whom to sum; sum over all if undefined
       * @param {Array.<string>} beneficiariesArray - names of
       *  beneficiaries over whom to sum; sum over all if undefined
       */
      this.sumBeneficiaryPercentages = function(stakeholderNames, beneficiaryNames) {
        if (typeof(stakeholderNames) === 'undefined') {
          stakeholderNames = Object.keys(fegsScopingData.stakeholders);
        }
        if (typeof(beneficiaryNames) === 'undefined') {
          beneficiaryArray = fegsScopingData.fegsBeneficiaries;
        } else {
          beneficiaryArray = beneficiaryNames;
        }
        sum = 0;
        for (var i = 0; i < stakeholderNames.length; i++) {
          for (var j = 0; j < beneficiaryArray.length; j++) {
            sum += +fegsScopingData.stakeholders[stakeholderNames[i]]
                    .beneficiaries[beneficiaryArray[j]]
                    .percentageOfStakeholder;
            }
        }
        console.log(sum)
      };

      /**
       * sum percentageOfBeneficiary for all optionally specified
       *  attributes for each optionally specified beneficiary;
       *  if no beneficiaries are specified then sum over all;
       *  if no attributes are specified then sum over all;
       * @param {Array.<string>} beneficiaryNames - names of
       *  beneficiaries over whom to sum; sum over all if undefined
       * @param {Array.<string>} attributeNames - names of
       *  attributes over which to sum; sum over all if undefined
       */
      this.sumAttributePercentages = function(beneficiaryNames, attributeNames) {
        if (typeof(beneficiaryNames) === 'undefined') {
          beneficiaryNames = Object.keys(this.attributes);
        }
        sum = 0;
        for (var j = 0; j < beneficiaryNames.length; j++) {
          if (typeof(attributeNames) === 'undefined') {
            attributeArray = Object.keys(this.attributes[beneficiaryNames[j]]);
          } else {
            attributeArray = attributeNames;
          }
          for (var k = 0; k < attributeArray.length; k++) {
            sum += +this.attributes[beneficiaryNames[j]][attributeArray[k]].percentageOfBeneficiary;
          }
        }
        console.log(sum)
      };

      /**
       * return {..., benName_i: percentageOfStakeholder_i, ...}
       *  for the named stakeholder
       */
      this.getEachBeneficiaryPercentage = function(stakeholderName) {
        var percentages = {};
        var beneficiaryNames = Object.keys(this.stakeholders[stakeholderName].beneficiaries);
        for (i = 0; i < beneficiaryNames.length; i++) {
          percentages[beneficiaryNames[i]] = this.stakeholders[stakeholderName].beneficiaries[beneficiaryNames[i]].percentageOfStakeholder
        }
        return percentages;
      };

      /**
       * return the sum of scores times stakeholder-score
       *  for each criterion
       * @param {string} stakeholders - stakeholder whose scores
       *  will be summed
       */
      this.scoresTimesScoresSum = function(stakeholder) {
        var criteria = Object.keys(this.scores);
        var sum = 0;
        for (var k = 0; k < criteria.length; k++) {
          if (typeof(this.stakeholders[stakeholder].scores[criteria[k]]) === 'undefined') {
            accessiblyNotify(stakeholder + ' has no score for ' + criteria[k]);
            continue;
          }
          sum += parseFloat(this.scores[criteria[k]]) * parseFloat(this.stakeholders[stakeholder].scores[criteria[k]]);
        }
        return sum;
      };

      /**
       * return the sum of beneficiary-scores for all stakeholders
       * @param {string} beneficiary - beneficiary whose
       *  scores are summed
       */
      this.beneficiaryScore = function(beneficiary) {
        var stakeholders = Object.keys(this.stakeholders);
        var numerator = 0;
        var denominator = 0;
        for (var i = 0; i < stakeholders.length; i++) {
          if (Object.keys(this.stakeholders[stakeholders[i]].beneficiaries).length) {
            var percentageOfStakeholder = parseFloat(this.stakeholders[stakeholders[i]].beneficiaries[beneficiary].percentageOfStakeholder);
            if (isNaN(percentageOfStakeholder)) {
              continue;
            }
            numerator += percentageOfStakeholder *
              parseFloat(this.scoresTimesScoresSum(stakeholders[i]));
          }
        }
        for (var i = 0; i < stakeholders.length; i++) {
          denominator += parseFloat(this.scoresTimesScoresSum(stakeholders[i]));
        }
        return numerator / denominator;
      };

      this.calculateAttributeScores = function() {
        var attributeScores = {};
        for (var i = 0; i < this.fegsAttributes.length; i++) {
          var sum = 0;
          for (var beneficiary in this.attributes) {
            var percentage = parseInt(this.attributes[beneficiary][this.fegsAttributes[i]].percentageOfBeneficiary);
            if (Number.isInteger(percentage) && percentage !== 0) {
              console.log("Beneficiary: " + beneficiary);
              console.log("Percentage: " + percentage);
              sum += percentage * this.beneficiaryScore(beneficiary);
            }
          }
          if (sum !== 0) {
            console.log("Attribute: " + this.fegsAttributes[i]);
            console.log("Sum: " + sum);
            attributeScores[this.fegsAttributes[i]] = sum;
          }
        }
        return attributeScores;
      };

      this.calculateAttributeScoresNew = function() {
        var totalSum = 0;
        var attributeScores = {};
        for (var i = 0; i < this.fegsAttributes.length; i++) {
          var attributeSum = 0;
          for (var beneficiary in this.attributes) {
            var percentage = parseInt(this.attributes[beneficiary][this.fegsAttributes[i]].percentageOfBeneficiary);
            if (Number.isInteger(percentage) && percentage !== 0) {
              //console.log("Beneficiary: " + beneficiary);
              //console.log("Percentage: " + percentage);
              attributeSum += percentage * this.beneficiaryScore(beneficiary);
            }
          }
          if (attributeSum !== 0) {
            //console.log("Attribute: " + this.fegsAttributes[i]);
            //console.log("attributeSum: " + attributeSum);	
          }
          attributeScores[this.fegsAttributes[i]] = attributeSum;
          totalSum += attributeSum;
        }
        console.log("Total: " + totalSum)

        for (var attribute in attributeScores) {
          attributeScores[attribute] = attributeScores[attribute] / totalSum * 100;
          console.log(attribute + ": " + attributeScores[attribute] / totalSum * 100)
        }
      };

      this.calculateAttributeScore = function(attribute) {
        var sum = 0;
        for (var beneficiary in this.attributes) {
          var percentage = parseInt(this.attributes[beneficiary][attribute].percentageOfBeneficiary);
          if (Number.isInteger(percentage) && percentage !== 0) {
            //console.log("Beneficiary: " + beneficiary);
            //console.log("Percentage: " + percentage);
            sum += percentage * this.beneficiaryScore(beneficiary);
          }
        }
        if (sum !== 0) {
          //console.log("Attribute: " + attribute);
          //console.log("Sum: " + sum);	
        }
        return sum;
      };

      /**
       * return the sum of stakeholder-scores for all stakeholders [stakeholder weight * relative weight / sum of relative weights]
       * @param {string} stakeholder - stakeholder whose
       *  scores are summed
       */
      this.stakeholderPrioritizationScores = function(stakeholder) {
        var score = 0;
        var overallScore = this.calculateOverallScore(); // sum of relative weights
        return score;
      };

      /**
       * return the overall score (sum of relative weights)
       */
      this.calculateOverallScore = function() {
        var elements = Object.values(fegsScopingData.scores);
        var overallScore = 0;
        for (var i = 0; i < elements.length; i++) {
          overallScore += +elements[i];
        }
        return overallScore;
      };

      /** return current array of extant beneficiaries */
      this.extantBeneficiaries = function() {
        var extantStakeholders = Object.keys(this.stakeholders);
        var extantBeneficiaries = [];
        var stakeholderIndex;
        var beneficiaryIndex;
        var beneficiaries;
        for (stakeholderIndex = 0; stakeholderIndex < extantStakeholders.length; stakeholderIndex++) {
          beneficiaries = Object.keys(this.stakeholders[extantStakeholders[stakeholderIndex]].beneficiaries);
          for (beneficiaryIndex = 0; beneficiaryIndex < beneficiaries.length; beneficiaryIndex++) {
            if (extantBeneficiaries.indexOf(beneficiaries[beneficiaryIndex]) === -1 &&
              this.stakeholders[extantStakeholders[stakeholderIndex]].beneficiaries[beneficiaries[beneficiaryIndex]].percentageOfStakeholder !== '') {
              extantBeneficiaries.push(beneficiaries[beneficiaryIndex]);
            }
          }
        }
        return extantBeneficiaries;
      };

      this.updateName = function(name) {
        this.projectName = name;
      };

      this.appName = 'FEGS Scoping Tool';
      this.version = '0.1.0';
      this.projectName = 'New Project';
      this.filePath = '';
      this.criteria = ['magnitude', 'influence', 'interest', 'urgency', 'proximity', 'economic-interest', 'rights', 'fairness', 'representation'];
      this.fegsCriteria = ['Magnitude & Probability of Impact', 'Level of influence', 'Level of Interest', 'Urgency & Temporal immediacy', 'Proximity', 'Economic interest', 'Rights', 'Fairness', 'Underrepresented & Underserved representation'];
      this.scores = this.makeCriteriaObject('0');
      this.stakeholders = {};
      this.attributes = {};
      this.fegsAttributes = ["Water quality", "Water quantity", "Water movement", "Land quantity", "Land quality", "Land availability", "Wind strength / speed", "Wind predictability / consistency", "Air quality", "Weather predictability", "Frequency of extreme weather events", "Soil availability", "Soil quality", "Substrate quantity", "Substrate quality", "Fuel quantity", "Availablability of fiber materials for use or subsistence", "Availability of minerals / chemicals", "Availability of other natural  materials for artistic use or consumption (e.g. shells, clay, acorns, honey)", "Flora community", "Edible flora / fungi", "Medicinal flora / fungi", "Structural flora / fungi", "Charismatic flora / fungi", "Aesthetic flora / fungi", "Rare flora / fungi", "Commercially important flora / fungi", "Spiritually/culturally important flora / fungi", "Fauna community", "Edible fauna", "Medicinal fauna", "Keystone fauna", "Charismatic fauna", "Aesthetic fauna", "Rare fauna", "Pollinating fauna", "Pest predator / depredator fauna", "Commercially important fauna", "Spiritually / culturally important fauna", "Sounds", "Scents", "Viewscapes", "Phenomena (e.g. sunsets, northern lights, etc)"];
      this.fegsBeneficiaries = ['Irrigators', 'CAFO Operators', 'Livestock grazers', 'Agricultural processors', 'Aquaculturalists', 'Farmers', 'Foresters', 'Food extractors', 'Timber / Fiber / Ornamental extractors', 'Industrial processors', 'Industrial dischargers', 'Energy generators', 'Resource dependent businesses', 'Pharmaceutical / Food supplement suppliers', 'Fur / Hide trappers / hunters', 'Municipal drinking water plant operators', 'Wastewater treatment plant operators', 'Residential property owners', 'Military / Coast Guard', 'Transporters of goods', 'Transporters of people', 'Water subsisters', 'Food subsisters', 'Timber / Fiber / Fur / Hide subsisters', 'Building material subsisters', 'Experiencers / viewers', 'Food pickers / gatherers', 'Hunters', 'Anglers', 'Waders / Swimmers / Divers', 'Boaters', 'Spiritual and ceremonial participants', 'Artists', 'Students and educators', 'Researchers', 'People who care (existence)', 'People who care (option, bequest)'];
    }; //////// END PROTOTYPE FEGScopingData ////////

    /** Prototype controller of communication between data and view */
    FEGSScopingController = function() {

      /** scrape data from the page and save the data */
      this.saveView = function(filename = "data.json") {
        var returnValue;
        var userAgent = navigator.userAgent.toLowerCase();
        if (userAgent.indexOf(' electron/') > -1) { // true if in NODE's ELECTRON
          returnValue = fegsScopingController.saveJSON('data.json', fegsScopingView.scrapePage());
        } else { // else is selected if this instance appears to be running in the browser
          returnValue = this.downloadText('data.json', JSON.stringify(fegsScopingView.scrapePage()));
        }
        return returnValue;
      };

      /** save validated data */
      this.saveValidatedData = function(filename) {
        if (!filename) {
          filename = 'data.json'
        }
        this.saveJSON(filename, fegsScopingData);
        fegsScopingView.indicateSaved();
      };

      /** update name of an instance of the app */
      this.updateName = function(name) {
        fegsScopingView.updateName(name);
        fegsScopingData.updateName(name);
      };

      this.getCurrentStakeholder = function() {
        return fegsScopingView.getCurrentStakeholder();
      };

      /** scrape state of page */
      this.scrapePage = function() {
        console.log("scrapePage")
        var scrapedValues;
        var scores = {};
        var beneficiaries = {};
        var attributes = {};
        var i;
        var j;
        for (i = 0; i < fegsScopingData.criteria.length; i++) { // save view-state of #table-scores
          scores[fegsScopingData.criteria[i] + '-score'] = document.getElementById(fegsScopingData.criteria[i] + '-score').value;
        }
        if (document.getElementById('table-beneficiaries').rows[0].cells.length > 2) { // scrape #table-beneficiaries conditioned upon whether table-beneficiaries is populated
          for (i = 0; i < fegsScopingData.fegsBeneficiaries.length; i++) { // loop through each row of the table
            if (+(document.getElementById('table-beneficiaries').rows[i + 1].cells.length) < 3) { // does the row have two th-elements?
              beneficiaries[fegsScopingData.fegsBeneficiaries[i]] = document.getElementById('table-beneficiaries').rows[i + 1].cells[1].firstChild.value; // scrape this beneficiary's value
            } else { // the row appears to have only one th as a label
              beneficiaries[fegsScopingData.fegsBeneficiaries[i]] = document.getElementById('table-beneficiaries').rows[i + 1].cells[2].firstChild.value; // scrape this beneficiary's value
            }
          }
        } else { // no beneficiaries are populated into #table-beneficiaries
          console.log('no attributes recorded from view');
        }
        for (i = 0; i < fegsScopingData.fegsBeneficiaries.length; i++) {
          attributes[fegsScopingData.fegsBeneficiaries[i]] = {};
          for (j = 0; j < fegsScopingData.fegsAttributes.length; j++) {
            attributes[fegsScopingData.fegsBeneficiaries[i]][fegsScopingData.fegsAttributes[j]] = tableAttributes.cellInputValue(tableAttributes.cell(fegsScopingData.fegsAttributes[j], fegsScopingData.fegsBeneficiaries[i]));
          }
        }
        /* //works in BROWSER
        document.getElementById('scrape-page').setAttribute('data-view-state', JSON.stringify({'scores': scores, 'beneficiaries': beneficiaries, 'attributes': attributes})); */
        scrapedValues = {
          'scores': scores,
          'beneficiaries': beneficiaries,
          'attributes': attributes
        };
        return scrapedValues;
      };

      /** save json to file; requires ELECTRON */
      this.saveJSON = function(savePath, jsonToBeSaved) {
        console.log("saveJSON")
        var fs = require('fs');
        var jsonText;
        if (typeof(jsonToBeSaved) !== 'string') {
          jsonText = JSON.stringify(jsonToBeSaved);
        } else {
          jsonText = jsonToBeSaved;
        }
        fs.writeFileSync(savePath, jsonText);
      };

      /** download given text to given filename; works in BROWSER */
      this.downloadText = function(filename, text) {
        console.log("FEGSScopingController downloadText")
        var element = document.createElement('a');
        element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
        element.setAttribute('download', filename);
        element.style.display = 'none';
        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);
      }

      /** read data-model from disk; requires ELECTRON */
      this.importData = function(filename) {
        if (typeof(process) === 'undefined' || !process.versions.electron) {
          console.log('electron is needed for importing data');
          return;
        }
        if (typeof(filename) === 'undefined') {
          filename = 'data.json'
        }
        importedData = require('fs').readFileSync(filename);
        importedData = JSON.parse(importedData);
        importedData = Object.assign(fegsScopingData, importedData);
        return importedData;
      };

    }; //////// END PROTOTYPE FEGSScopingController ////////

    /** sum all values in an object */
    var sum = function(obj) {
      var sum = 0;
      for (var el in obj) {
        if (obj.hasOwnProperty(el)) {
          sum += parseFloat(obj[el]);
        }
      }
      return sum;
    }

    /** pie chart */
    var initPieChart = {
      draw: function(config) {
        var me = this;
        var domEle = config.element;
        var data = config.data;
        var colors = config.colors;
        var width = 400;
        var height = 480;
        var radius = Math.min(width, height) / 2;

        var legendRectSize = 18;
        var legendSpacing = 4;

        var color = d3.scaleOrdinal(colors); // Set the colors

        var pie = d3.pie().value(function(d) {
          return d.value;
        })(data);

        var tip = d3.tip()
          .attr('class', 'd3-tip')
          .offset([50, 0])
          .html(function(d) { 
            console.log("init tip")
            return d.data.label + ": " + d.data.value + "%";
          });

        var arc = d3.arc()
          .outerRadius(radius - 10)
          .innerRadius(0);

        d3.selectAll('.' + domEle + ' > *').remove();

        for (var prop in pie) {
          if (pie[prop].value) {
            var element = document.getElementById(domEle);
            if (element) {
              element.removeAttribute("hidden");
            }
            break;
          }
        }

        var svg = d3.selectAll("." + domEle)
          .append("svg")
          .attr("width", width)
          .attr("height", height)
          .append("g")
          .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")"); // Moving the center point. 1/2 the width and 1/2 the height

        svg.call(tip);

        var g = svg.selectAll("arc")
          .data(pie)
          .enter().append("g")
          .attr("class", "arc");

        g.append("path")
          .attr("d", arc)
          .style("fill", function(d) {
            return color(d.index);
          })
          .on('mouseover', tip.show)
          .on('mouseout', tip.hide)
          .each(function(d) {
            this._current = d;
          }); // store the initial angles

        //update
        function change() {
          var pie = d3.pie().sort(null)
            .value(function(d) {
              return d.value;
            })(data);

          var tip = d3.tip()
          .attr('class', 'd3-tip')
          .offset([50, 0])
          .html(function(d) { 
            console.log("change tip")
            return d.data.label + ": " + d.data.value;
          });

          svg.call(tip);
            
          function checkD3Data(chart) {
            for (var prop in chart) {
              if (pie[prop].value) {
                return true;
              }
            }
            return false;
          }
          
          var element = document.getElementById(domEle);
          if (element) {
            if (checkD3Data(pie)) {
              document.getElementById(domEle).removeAttribute("hidden");
            } else {
              document.getElementById(domEle).setAttribute("hidden", "");
            }
          }

          path = d3.selectAll("." + domEle)
            .selectAll("path")
            .data(pie)
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide);

          path.transition().duration(500).attrTween("d", arcTween); // Smooth transition with arcTween
        }

        if (domEle === "criteria-pie") {
          d3.selectAll(".scoring input")
          .on("input", function() {
            clearNotices();
            var value = parseInt(this.value, 10);
            var isValid = validateInput(value, 1, 100);
            if (isValid) {
              this.classList.remove('invalid-text-input');
              fegsScopingData.scores[this.id.replace('-score', '')] = value;
              data = getScores();
              change();
              initStackedBarChart.draw({
                data: formatStakeholderData(),
                key: fegsScopingData.criteria,
                element: 'stakeholder-barchart',
                header: 'stakeholder',
                colors: criteriaColors
              });
            } else {
              this.classList.add('invalid-text-input');
              accessiblyNotify('Enter a number between 1 and 100');
            }
            updateWeightingProgress();
            fegsScopingView.indicateUnsaved();
          });
        }

        function arcTween(a) {
          var i = d3.interpolate(this._current, a);
          this._current = i(0);
          return function(t) {
            return arc(i(t));
          };
        }
      }
    };

    /**
     * Check if value is between min and max (inclusive)
     * @function
     * @return {bool} - A bool
     */
    var validateInput = function(value, min, max) {
      if (!isNaN(value)) {
        if (value > max || value < min) {
          return false;
        } else {
          return true;
        }
      } else {
        return false;
      }
    };

    /**
     * Get the data for the global scores and return them in a JSON object.
     * @function
     * @return {object} - A JSON object containing the criteria and their scores. 
     */
    function getScores() {
      var data = [];
      for (var prop in fegsScopingData.scores) {
        data.push({
          label: prop,
          value: fegsScopingData.scores[prop]
        });
      }
      return data;
    }

    function getBeneficiaryScoresForPieChart() {
      var data = [];
      for (var i = 0; i < fegsScopingData.fegsBeneficiaries.length; i++) {
        var bene = {};
        bene.label = fegsScopingData.fegsBeneficiaries[i];
        bene.value = fegsScopingData.beneficiaryScore(fegsScopingData.fegsBeneficiaries[i]);
        data.push(bene);
      }
      return data;
    }

    function getBeneficiaryScoresForBarChart() {
      var data = [];
      for (var i = 0; i < fegsScopingData.fegsBeneficiaries.length; i++) {
        var obj = {};
        var beneficiary = fegsScopingData.fegsBeneficiaries[i];
        for (var stakeholder in fegsScopingData.stakeholders) {
          var percentageOfStakeholders = fegsScopingData.stakeholders[stakeholder].beneficiaries[beneficiary].percentageOfStakeholder;
          if (percentageOfStakeholders) {
            if (!obj.hasOwnProperty("beneficiary")) {
              obj["beneficiary"] = beneficiary;
              obj.total = 0;
            }
            //obj[stakeholder] = percentageOfStakeholders;
            //obj.total += +percentageOfStakeholders;

            obj[stakeholder] = fegsScopingData.beneficiaryScore(beneficiary);
            obj.total += fegsScopingData.beneficiaryScore(beneficiary);
          }
        }
        if (obj.hasOwnProperty("beneficiary")) {
          data.push(obj);
        }
      }
      return data;
    }

    function getAttributeScoresForPieChart() {
      var data = [];
      var sumOfBeneficiaryScores = 0;
      for (var i = 0; i < fegsScopingData.extantBeneficiaries().length; i++) {
        console.log(fegsScopingData.extantBeneficiaries()[i]);
        console.log(fegsScopingData.beneficiaryScore(fegsScopingData.extantBeneficiaries()[i]));
        sumOfBeneficiaryScores += fegsScopingData.beneficiaryScore(fegsScopingData.extantBeneficiaries()[i]);
      }
      for (var i = 0; i < fegsScopingData.fegsAttributes.length; i++) {
        var sum = 0;
        for (var beneficiary in fegsScopingData.attributes) {
          var percentage = parseInt(fegsScopingData.attributes[beneficiary][fegsScopingData.fegsAttributes[i]].percentageOfBeneficiary);
          if (Number.isInteger(percentage) && percentage !== 0) {
            sum += percentage * fegsScopingData.beneficiaryScore(beneficiary);
          }
        }
        if (sum !== 0) {
          var datum = {};
          datum.label = fegsScopingData.fegsAttributes[i];
          datum.value = sum / sumOfBeneficiaryScores;
          data.push(datum);
        }
      }
      return data;
    }

    document.getElementById("stakeholder-group").addEventListener("keyup", function(event) {
      event.preventDefault();
      if (event.keyCode === 13) {
        document.getElementById("add-stakeholder").click();
      }
    });

    /**
     * Adds a stakeholder based on the input data
     * @function
     */
    function addStakeholder() {
      var weights = fegsScopingData.makeCriteriaObject({});
      var stakeholderGroupInput = document.getElementById('stakeholder-group');
      var stakeholderGroup = stakeholderGroupInput.value;
      stakeholderGroupInput.value = '';

      if (Object.keys(fegsScopingData.stakeholders).indexOf(stakeholderGroup) !== -1) { // if the stakeholder exists or is blank.
        accessiblyNotify('A stakeholder with this name already exists.');
        return;
      } else if (stakeholderGroup.trim() === "") {
        accessiblyNotify('Enter a valid stakeholder name.');
        return;
      }
      fegsScopingData.addStakeholder(stakeholderGroup, weights); // add the stakeholder to the model
      document.getElementById('set-stakeholder-values').style.display = "block";
      document.getElementById('stakeholder-list').style.display = "block";

      var stakeholderList = document.getElementById('stakeholder-list'); // create the stakeholder list
      var li = document.createElement('li');
      li.setAttribute('data-stakeholder', stakeholderGroup);
      li.appendChild(document.createTextNode(stakeholderGroup));

      var button = document.createElement('button');
      button.setAttribute('class', 'remove-stakeholder');
      button.setAttribute('aria-label', 'remove stakeholder');
      button.innerHTML = '&#215;';

      button.addEventListener("click", function() { // create listeners for the remove stakeholder button
        var stakeholder = this.parentNode.getAttribute('data-stakeholder');
        var elementsToRemove = document.querySelectorAll('[data-stakeholder="' + stakeholder + '"]');
        for (var i = 0, length = elementsToRemove.length; i < length; i++) {
          elementsToRemove[i].remove();
        }
        fegsScopingData.removeStakeholders([stakeholder]);
        updateStakeholderProgress();
        if (document.getElementById("stakeholder-list").children.length === 0) {
          document.getElementById('set-stakeholder-values').style.display = "none";
        }
      });

      li.appendChild(button);
      stakeholderList.appendChild(li); // append the button and li elements to the ul

      var lists = document.getElementsByClassName('stakeholder-value-list');
      for (var i = 0; i < lists.length; i++) { // Create the score inputs for the added stakeholder
        var ul = lists[i];
        var li = document.createElement('li');
        li.setAttribute('class', 'stakeholder-score-item');
        li.setAttribute('data-stakeholder', stakeholderGroup);
        li.appendChild(document.createTextNode(stakeholderGroup));

        var input = document.createElement('input');
        input.setAttribute('type', 'number');
        input.setAttribute('min', '0');
        input.setAttribute('max', '100');
        input.setAttribute('step', '1');
        input.setAttribute('class', 'stakeholder-score-input');
        input.setAttribute('id', stakeholderGroup + '-' + ul.getAttribute('data-criterion'));
        input.setAttribute('data-criterion', ul.getAttribute('data-criterion'));
        input.oninput = function(){validateStakeholderScore(this);updateStakeholderProgress();};
        li.appendChild(input);
        ul.appendChild(li);
      }
      updateStakeholderProgress();
      fegsScopingView.indicateUnsaved();
    }

    function addStakeholderScores() {
      console.log('addStakeholderScores')
      var stakeholdersToAdd = scrapeAddStakeholders();
      for (var stakeholder in stakeholdersToAdd) {
        fegsScopingData.addStakeholder(stakeholder, stakeholdersToAdd[stakeholder]);
        addRow('table-stakeholders', [stakeholder, fegsScopingData.stakeholders[stakeholder]]); // table name and array of values to insert
      }
      document.getElementById('set-stakeholder-values').style.display = "none";
      document.getElementById('stakeholder-list').style.display = "none";
      clearStakeholderScores();
      initStackedBarChart.draw({
        data: formatStakeholderData(),
        key: fegsScopingData.criteria,
        element: 'stakeholder-barchart',
        header: 'stakeholder',
        colors: criteriaColors
      });
      updateSelectStakeholder('select-stakeholder');
      document.getElementById('select-stakeholder').onchange();
      updateStakeholderProgress();
      document.getElementById('stakeholder-table-container').style.display = "block";
      fegsScopingView.indicateUnsaved();
      document.getElementById("stakeholder-table-container").scrollIntoView();
    }

    function clearStakeholderScores() {
      var items = document.getElementsByClassName('stakeholder-score-item');
      for (var i = items.length - 1; i >= 0; i--) {
        items[i].parentNode.removeChild(items[i]);
      }

      var names = document.getElementById('stakeholder-list');
      for (var j = names.children.length - 1; j >= 0; j--) {
        names.removeChild(names.children[j]);
      }
    }

    /*
      Scrape the values from the stakeholder inputs
    */
    function scrapeAddStakeholders() {
      var stakeholdersToAdd = {};
      var stakeholderScoreInputs = document.getElementsByClassName('stakeholder-score-input');
      for (var i = 0; i < stakeholderScoreInputs.length; i++) {
        var stakeholder = stakeholderScoreInputs[i].parentNode.getAttribute('data-stakeholder');
        var criterion = stakeholderScoreInputs[i].getAttribute('data-criterion');
        if (!stakeholdersToAdd.hasOwnProperty(stakeholder)) {
          stakeholdersToAdd[stakeholder] = {};
          var value = parseInt(stakeholderScoreInputs[i].value, 10);
          var isValid = validateInput(value, 0, 100);
          if (isValid) {
            stakeholdersToAdd[stakeholder][criterion] = value;
          } else {
            accessiblyNotify("Invalid inputs. Please review your stakeholder weights.")
            return {};
          }
          // } else if (criterion === "magnitude") {
          //   var sum = +stakeholdersToAdd[stakeholder][criterion] + +stakeholderScoreInputs[i].value;
          //   stakeholdersToAdd[stakeholder][criterion] = (sum >= 20 ? sum - 20 : 0) + '';
        } else {
          stakeholdersToAdd[stakeholder][criterion] = stakeholderScoreInputs[i].value;
        }
      }
      return stakeholdersToAdd;
    }

    function validateStakeholderScore(that) {
      clearNotices();
      var value = parseInt(that.value, 10);
      var isValid = validateInput(value, 0, 100);
      if (!isValid) {
        accessiblyNotify("Please enter a value between 0 and 100")
        that.classList.add('invalid-text-input');
      } else {
        that.classList.remove('invalid-text-input');
        clearNotices();
      }
    }

    function updateStakeholderProgress() {
      var stakeholderCount = Object.keys(fegsScopingData.stakeholders).length;
      if (stakeholderCount === 0) {
        document.getElementById('stakeholder-progress').innerHTML = "Add a stakeholder";
        return;
      }
      var newText = '';
      for (var stakeholder in fegsScopingData.stakeholders) {
        var completeCount = 0;
        var added = false;
        for (var criterion in fegsScopingData.stakeholders[stakeholder].scores) {
          if (fegsScopingData.stakeholders[stakeholder].scores[criterion]) {
            newText += stakeholder + ': added<br />';
            added = true;
            break;
          } else {
            var inputScore = document.getElementById(stakeholder + '-' + criterion).value;
            if (inputScore !== "" && inputScore <= 100 && inputScore > 0) {
              completeCount++;
            }
          }
        }
        if (!added) {
          newText += stakeholder + ': ' + completeCount + '/' + Object.keys(fegsScopingData.stakeholders[stakeholder].scores).length + ' criteria entered<br />';
        }
      }

      document.getElementById('stakeholder-progress').innerHTML = newText;
      updateBeneficiaryProgress();
    }

    function updateBeneficiaryProgress() {
      var stakeholderCount = Object.keys(fegsScopingData.stakeholders).length;
      if (stakeholderCount === 0) {
        document.getElementById('beneficiaries-progress').innerHTML = "Add a stakeholder";
        return;
      }
      var completeCount = stakeholderCount;
      for (var stakeholder in fegsScopingData.stakeholders) {
        if (!Object.keys(fegsScopingData.stakeholders[stakeholder].beneficiaries).length) {
          completeCount--;
        }
      }
      if (completeCount > 0) {
        var percentageSum = 0;
        var j, inputs, input;
        inputs = document.getElementsByClassName('beneficiary-percentage-of-stakeholder');
        for (j = 0; j < inputs.length; j++) {
          percentageSum += +inputs[j].value;
        }
        if (percentageSum < 99.95 || percentageSum > 100.05) { // inform user of unnormalized percentages
          completeCount--;
        }
      }
      document.getElementById('beneficiaries-progress').innerHTML = completeCount + " of " + stakeholderCount + " stakeholders completed";
    }

    function updateAttributeProgress() {
      var beneficiaryCount = fegsScopingData.extantBeneficiaries().length;
      if (beneficiaryCount === 0) {
        document.getElementById('attributes-progress').innerHTML = "Add a beneficiary";
        return;
      }
      var completeCount = 0;
      for (var beneficiary in fegsScopingData.attributes) {
        for (var attribute in fegsScopingData.attributes[beneficiary]) {
          if (fegsScopingData.attributes[beneficiary][attribute].percentageOfBeneficiary !== "") {
            completeCount++;
            break;
          }
        }
      }
      document.getElementById('attributes-progress').innerHTML = completeCount + " of " + beneficiaryCount + " beneficiaries completed";
    }

    function updateWeightingProgress() {
      // Count the empty weights and display a progress counter
      var inputs = document.querySelectorAll('.scoring input');
      var emptyInputs = [];
      for (var i = 0; i < inputs.length; i++) {
        if (!inputs[i].value || inputs[i].classList.contains('invalid-text-input')) {
          emptyInputs.push(inputs[i]);
        }
      }
      document.getElementById('weighting-progress').innerHTML = inputs.length - emptyInputs.length + " of " + inputs.length + " criteria completed";
    }

    var formatStakeholderData = function() {
      var data = [];
      for (var stakeholderGroup in fegsScopingData.stakeholders) {
        var stakeholder = {};
        stakeholder.stakeholder = stakeholderGroup;
        for (var criterion in fegsScopingData.stakeholders[stakeholderGroup].scores) {
          stakeholder[criterion] = +fegsScopingData.stakeholders[stakeholderGroup].scores[criterion] * (+fegsScopingData.scores[criterion] / sum(fegsScopingData.scores));
        }
        data.push(stakeholder);
      }
      return data;
    };

    var formatBeneficiaryData = function() {
      var data = [];
      for (var i = 0; i < fegsScopingData.fegsBeneficiaries.length; i++) {
        var beneficiary = {};
        var beneficiaryName = fegsScopingData.fegsBeneficiaries[i];
        for (var stakeholder in fegsScopingData.stakeholders) {
          if(fegsScopingData.stakeholders[stakeholder].beneficiaries.hasOwnProperty(beneficiaryName) && fegsScopingData.stakeholders[stakeholder].beneficiaries[beneficiaryName].percentageOfStakeholder != '') {
            beneficiary[stakeholder] = fegsScopingData.beneficiaryScore(beneficiaryName);
          }
        }
        if (Object.keys(beneficiary).length !== 0) {
          beneficiary.beneficiary = beneficiaryName;
          data.push(beneficiary);
        }
      }
      return data;
    };

    /**
     * Gets the checked value of a specified name of ratio inputs.
     * @function
     * @param {string} name - The name of the radio buttons.
     * @return {string} - The value associated with the checked radio button.
     */
    function getCheckedValueByName(name) {
      var elements = document.getElementsByName(name);
      for (var i = 0, length = elements.length; i < length; i++) {
        if (elements[i].checked) {
          return elements[i].value;
        }
      }
    }

    /**
     * Adds a row containing the specified data to the table, with appropriate listeners.
     * @function
     * @param {string} tableID - The ID of the table element.
     * @param {array} rowData - An array containing the data to display in the table.
     */
    function addRow(tableID, rowData) {
      var tableRef = document.getElementById(tableID).getElementsByTagName('tbody')[0]; // Get a reference to the table
      var newRow = tableRef.insertRow(); // Insert a row in the table at row index 0

      var editButton = createButton('Edit', 'edit-button'); // Create Buttons
      var saveButton = createButton('Save', 'save-button');
      saveButton.setAttribute("aria-hidden", "true");
      var removeButton = createButton('Remove', 'remove-button');

      var newCell = newRow.insertCell(); // Insert a cell in the row to hold the buttons
      newCell.appendChild(editButton);
      newCell.appendChild(saveButton);
      newCell.appendChild(removeButton);

      removeButton.addEventListener("click", function() { // create listeners for the buttons
      console.log("click remove")
        var stakeholder = this.parentNode.nextSibling.innerHTML;
        fegsScopingData.removeStakeholders([stakeholder]);
        this.parentNode.parentNode.remove();
        removeOptionFromSelect('select-stakeholder', stakeholder);
        initStackedBarChart.draw({
          data: formatStakeholderData(),
          key: fegsScopingData.criteria,
          element: 'stakeholder-barchart',
          header: 'stakeholder',
          colors: criteriaColors
        });
        var stakeholderCount = Object.keys(fegsScopingData.stakeholders).length;
        if (stakeholderCount === 0) {
          document.getElementById('stakeholder-table-container').style.display = "none";
        }
      });

      editButton.addEventListener("click", function() {
        this.setAttribute("aria-hidden", "true"); // hide the edit button
        var row = this.parentNode.parentNode;
        row.getElementsByClassName('save-button')[0].removeAttribute('aria-hidden'); // show the save button
        var cells = row.cells;
        for (var i = 1, length = cells.length; i < length; i++) {
          var cell = cells[i];
          var text = cell.innerHTML;
          cell.innerHTML = '<input class="form-text" data-original-value="' + text + '" type="text" value="' + text + '"/>'; // create an input with the cell value
        }
      });

      saveButton.addEventListener("click", function() {
        console.log("click save")
        this.setAttribute("aria-hidden", "true"); // hide the save button
        var row = this.parentNode.parentNode;
        row.getElementsByClassName('edit-button')[0].removeAttribute('aria-hidden'); // show the edit button
        var cells = row.cells;
        var originalStakeholderName = cells[1].innerText;
        if (cells[1].firstElementChild.hasAttribute("data-original-value")) {
          originalStakeholderName = cells[1].firstElementChild.getAttribute("data-original-value");
        }
        for (var i = 1, length = cells.length; i < length; i++) {
          var cell = cells[i];
          cell.innerHTML = cell.firstElementChild.value; // set the value of the cell to the value of the child input of the cell
        }
        var scores = {};
        for (var j = 0; j < fegsScopingData.criteria.length; j++) {
          var cell = document.getElementById(originalStakeholderName + '-' + fegsScopingData.criteria[j]);
          scores[fegsScopingData.criteria[j]] = cell.innerHTML;
          cell.id = cells[1].innerText + '-' + fegsScopingData.criteria[j];
        }
        scores = fegsScopingData.makeCriteriaObject(scores);
        var inputStakeholderValue = document.getElementById(originalStakeholderName + '-' + fegsScopingData.criteria[j])
        if (cells[1].innerText !== originalStakeholderName) {
          fegsScopingData.renameStakeholder(originalStakeholderName, cells[1].innerText);
        } else {
          fegsScopingData.addStakeholder(originalStakeholderName, scores);
        }
        fegsScopingData.stakeholders[cells[1].innerText].scores = scores;
        updateSelectStakeholder('select-stakeholder'); // update select-box that its entries have changed
        initStackedBarChart.draw({
          data: formatStakeholderData(),
          key: fegsScopingData.criteria,
          legend: fegsScopingData.fegsCriteria,
          element: 'stakeholder-barchart',
          header: 'stakeholder',
          colors: criteriaColors
        });
      });
      var newCell = newRow.insertCell(); // Insert a cell in the row at index 0
      var newText = document.createTextNode(rowData[0]); // Append a text node to the cell
      newCell.appendChild(newText);
      for (var i = 0, length = fegsScopingData.criteria.length; i < length; i++) {
        var newCell = newRow.insertCell(); // Insert a cell in the row at index 0
        var newText = document.createTextNode(rowData[1].scores[fegsScopingData.criteria[i]]); // Append a text node to the cell
        newCell.id = rowData[0] + '-' + fegsScopingData.criteria[i];
        newCell.appendChild(newText);
      }
    }

    /**
     * Creates an HTML button element with the text and class specified.
     * @function
     * @param {string} text - The text to be displayed on the button.
     * @param {string} className - The class to assign to the button.
     * @return {Element} - The HTML button element.
     */
    function createButton(text, className) {
      var button = document.createElement("button");
      button.innerHTML = text;
      button.className = className;
      return button;
    }

    /**
     * Toggles the visibility of the spefied element.
     * @function
     * @param {string} id - The ID of the element to toggle visiibility.
     */
    function toggleVisibility(id) {
      var element = document.getElementById(id);
      if (element.style.display === "block") {
        element.style.display = "none";
      } else {
        element.style.display = "block";
      }
    }

    /** stacked bar-chart */
    var initStackedBarChart = {
      draw: function(config) {
        var me = this;
        var domEle = config.element;
        var stackKey = config.key;
        var legendKey = config.legend;
        var data = config.data;
        var header = config.header;
        var colors = config.colors;
        var margin = {
          top: 20,
          right: 20,
          bottom: 30,
          left: 50
        };
        var width = 550 - margin.left - margin.right;
        var height = 400 - margin.top - margin.bottom;
        var xScale = d3.scaleBand().range([0, width]).padding(0.1);
        var yScale = d3.scaleLinear().range([height, 0]);
        var color = d3.scaleOrdinal(colors);
        var xAxis = d3.axisBottom(xScale);
        var yAxis = d3.axisLeft(yScale);
        var container = d3.select("#" + domEle);

        container.selectAll('svg').remove();

        if (data.length === 0) {
          return; // if there's no data to display don't display anything!
        }
        console.log(data)
        var svg = container.append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + 10 + margin.bottom + 10 + 30)
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var tip = d3.tip()
          .attr('class', 'd3-tip')
          .offset([50, 0])
          .html(function(d) { 
            return (d[1] - d[0]);
          });

        var stack = d3.stack()
          .keys(stackKey)
          .order(d3.stackOrderNone)
          .offset(d3.stackOffsetNone);

        var layers = stack(data);
        data.sort(function(a, b) {
          return b.total - a.total;
        });
        xScale.domain(data.map(function(d) {
          return d[header];
        }));
        yScale.domain([0, 100]);

        var layer = svg.selectAll(".layer")
          .data(layers)
          .enter().append("g")
          .attr("class", "layer")
          .style("fill", function(d, i) {
            return color(i);
          });

        layer.selectAll("rect")
          .data(function(d) {
            return d;
          })
          .enter().append("rect")
          .attr('class', 'bar')
          .attr("x", function(d) {
            return xScale(d.data[header]);
          })
          .attr("y", function(d) {
            return yScale(d[1]);
          })
          .attr("height", function(d) {
            return yScale(d[0]) - yScale(d[1]);
          })
          .attr("width", xScale.bandwidth())
          .on('click', function(d, i) {
            d3.selectAll('.bar').classed('selected', false);
            d3.select(this).classed('selected', true);
          })
          // .on('mouseover', tip.show)
          // .on('mouseout', tip.hide);

        svg.append("g")
          .attr("class", "axis axis--x")
          .attr("transform", "translate(0," + (height + 5) + ")")
          .call(xAxis)
          .selectAll(".tick text")
          .call(wrap, xScale.bandwidth());

        svg.append("g")
          .attr("class", "axis axis--y")
          .attr("transform", "translate(0,0)")
          .call(yAxis);

        if (legendKey) {
          var legend = svg.append("g")
          .attr("font-family", "sans-serif")
          .attr("font-size", 10)
          .attr("text-anchor", "end")
          .selectAll("g")
          .data(legendKey)
          .enter().append("g")
          .attr("transform", function(d, i) {
              return "translate(0," + i * 20 + ")";
          });

        legend.append("rect")
          .attr("x", width - 19)
          .attr("width", 19)
          .attr("height", 19)
          .attr("fill", function(d, i) {return colors[i];});

        legend.append("text")
          .attr("x", width - 24)
          .attr("y", 9.5)
          .attr("dy", "0.32em")
          .text(function(d) {
              return d;
          });
        }

        return container;
      }
    };

    function wrap(text, width) {
      text.each(function() {
        var text = d3.select(this),
            words = text.text().split(/\s+/).reverse(),
            word,
            line = [],
            lineNumber = 0,
            lineHeight = 1.1, // ems
            y = text.attr("y"),
            dy = parseFloat(text.attr("dy")),
            tspan = text.text(null).append("tspan").attr("x", 0).attr("y", y).attr("dy", dy + "em");
        while (word = words.pop()) {
          line.push(word);
          tspan.text(line.join(" "));
          if (tspan.node().getComputedTextLength() > width) {
            line.pop();
            tspan.text(line.join(" "));
            line = [word];
            tspan = text.append("tspan").attr("x", 0).attr("y", y).attr("dy", ++lineNumber * lineHeight + dy + "em").text(word);
          }
        }
      });
    }

    /** stacked bar-chart */
    var initBarChart = {
      draw: function(config) {
        var me = this;
        var domEle = config.element;
        var stackKey = config.key;
        var legendKey = config.legend;
        var data = config.data;
        var header = config.header;
        var colors = config.colors;
        var margin = {
          top: 20,
          right: 20,
          bottom: 30,
          left: 50
        };
        var width = (data.length * 60 > 1200 ? 1200 : data.length * 50) - margin.left - margin.right;
        var height = 400 - margin.top - margin.bottom;
        var xScale = d3.scaleBand().range([0, width]).padding(0.3);
        var yScale = d3.scaleLinear().range([height, 0]);
        var color = d3.scaleOrdinal(colors);
        var xAxis = d3.axisBottom(xScale);
        var yAxis = d3.axisLeft(yScale);
        var container = d3.select("#" + domEle);

        container.selectAll('svg').remove();

        //
        var svg = container.append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + 10 + margin.bottom + 10 + 30)
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var g = svg.append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        if (data.length === 0) {
          return; // if there's no data to display don't display anything!
        }
        console.log(data)
        xScale.domain(data.map(function(d) { return d.label; }));
        yScale.domain([0, d3.max(data, function(d) { return d.value; })]);

        g.append("g")
            .attr("class", "axis axis--x")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(xScale))
            .selectAll(".tick text")
            .call(wrap, xScale.bandwidth());

        g.append("g")
            .attr("class", "axis axis--y")
            .call(d3.axisLeft(yScale))
          .append("text")
            .attr("transform", "rotate(-90)")
            .attr("y", 6)
            .attr("dy", "0.71em")
            .attr("text-anchor", "end")
            .text("Attribute Score");

        g.selectAll(".bar")
          .data(data)
          .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d) { return xScale(d.label); })
            .attr("y", function(d) { return yScale(d.value); })
            .attr("width", xScale.bandwidth())
            .attr("height", function(d) { return height - yScale(d.value); });
      }
    };

    var getStakeholderPrioritizationsFromTable = function() {
      var table = document.getElementById('table-stakeholders');
      var tbody = table.getElementsByTagName('tbody')[0]; // get all rows of body
      var rows = tbody.getElementsByTagName('tr');
      var data = [];
      if (rows.length > 0) {
        for (var i = 0; i < rows.length; i++) {
          data[i] = {};
          cells = rows[i].getElementsByTagName('td');
          data[i]['stakeholder'] = cells[1].innerText;
          for (var j = 2; j < cells.length; j++) {
            data[i][fegsScopingData.criteria[j - 2]] = cells[j].innerText;
          }
        }
      }
      return data; // return data as array of objects with criteria as keys
    };

    /**
     * Add a column of data to the table with id tableId.
     * @param {string} tableId - id of table
     * @param {string} columnName - name of column to use as header
     * @param {string} dataArray - array whose elements will populate
     *  the columns where column i + 1 gets ith element of the array
     */
    var addTableColumn = function(tableId, columnName, dataArray) {
      var table = document.getElementById(tableId);
      table.tHead.rows[0].innerHTML += '<th>' + columnName + '</th>';
      for (var i = 0; i < dataArray.length; i++) {
        table.tBodies[0].rows[i].innerHTML += '<td>' + dataArray[i] + '</td>';
      }
    };

    /**
     * Returns the cell of the table by given (x;y) coordinates considering
     *  colSpan and rowSpan of the cells.
     * @param {HTMLElement} table - HTML table
     * @param {number} x - X position in table matrix
     * @param {number} y - Y position in table matrix
     * @returns {HTMLElement|null}
     */
    var getTableCell = function(table, x, y) {
      var m = [],
        row, cell, xx, tx, ty, xxx, yyy;
      for (yyy = 0; yyy < table.rows.length; yyy++) {
        row = table.rows[yyy];
        for (xxx = 0; xxx < row.cells.length; xxx++) {
          cell = row.cells[xxx];
          xx = xxx;
          for (; m[yyy] && m[yyy][xx]; ++xx) {}
          for (tx = xx; tx < xx + cell.colSpan; ++tx) {
            for (ty = yyy; ty < yyy + cell.rowSpan; ++ty) {
              if (!m[ty])
                m[ty] = [];
              m[ty][tx] = true;
            }
          }
          if (xx <= x &&
            x < xx + cell.colSpan &&
            yyy <= y &&
            y < yyy + cell.rowSpan)
            return cell;
        }
      }
      return null;
    };

    /** Add an option with given value and text to a given select-box. */
    var addOption = function(selectId, optionText, optionValue) {
      var select = document.getElementById(selectId);
      var optionToAdd = document.createElement('option');
      optionToAdd.innerText = optionText;
      optionToAdd.value = optionValue;
      select.add(optionToAdd);
    };

    /** update select-element's options */
    /** DUPE of updateSelectStakeholder unless modified **/
    updateSelect = function(selectId, options) {
      var options = Object.keys(fegsScopingData.stakeholders);
      var oldOptions = document.querySelectorAll('#' + selectId + ' option:not([disabled="disabled"])');
      var i;
      for (i = 0; i < oldOptions.length; i++) {
        oldOptions[i].parentNode.removeChild(oldOptions[i]);
      }
      for (i = 0; i < options.length; i++) {
        addOption(selectId, options[i], options[i]);
      }
      selectStakeholderToSlice();
    };

    /**
     * Populate a stakeholder's beneficiary-percentages into the view.
     *
     * Put each value in a text-input.
     * Validate data-entry by notifying when sum of inputs > 100.
     */
    var selectStakeholderToSlice = function() {
      var table = document.getElementById('table-beneficiaries');
      var select = document.getElementById('select-stakeholder');
      var stakeholderName = select.value;
      var tBody = table.tBodies[0];
      var rowIndex, cell, input, cellText, rowspan, numberOfBeneficiaryColumnsInRow;

      var beneficiaryPercentageOfStakeholderInputValidator = function() { // validate sum of percentages is 100 +- 0.05 then save
        console.log("beneficiaryPercentageOfStakeholderInputValidator")
        var percentageSum = 0;
        var j, inputs, input;
        inputs = document.getElementsByClassName('beneficiary-percentage-of-stakeholder');
        for (j = 0; j < inputs.length; j++) {
          if (isNaN(parseFloat(inputs[j].value))) {
            inputs[j].parentElement.style = 'background-color: red';
          }
          percentageSum += +inputs[j].value;
        }
        if (percentageSum < 99.95 || percentageSum > 100.05) { // inform user of unnormalized percentages
          accessiblyNotify('Percentages must sum to 100. The current sum is ' + percentageSum);
          for (j = 0; j < inputs.length; j++) {
            inputs[j].parentElement.style = 'background-color: red';
          }
        } else { // update data with valid input
          clearNotices();
          for (j = 0; j < inputs.length; j++) {
            inputs[j].parentElement.style = 'background-color: initial';
            beneficiaryNameForInput = inputs[j].parentElement.parentElement.cells[inputs[j].parentElement.cellIndex - 2].innerText;
            if (!fegsScopingData.stakeholders[stakeholderName].beneficiaries || !fegsScopingData.stakeholders[stakeholderName].beneficiaries[beneficiaryNameForInput]) {
              fegsScopingData.addBeneficiary(stakeholderName, beneficiaryNameForInput, inputs[j].value);
            }
            fegsScopingData.stakeholders[stakeholderName]
              .beneficiaries[beneficiaryNameForInput]
              .percentageOfStakeholder = inputs[j].value;
            fegsScopingView.indicateUnsaved();
          }

          document.getElementById("beneficiary-charts").removeAttribute('hidden');
          initStackedBarChart.draw({
            data: formatBeneficiaryData(),
            key: Object.keys(fegsScopingData.stakeholders),
            legend: Object.keys(fegsScopingData.stakeholders),
            element: 'beneficiary-barchart',
            header: 'beneficiary',
            colors: d3.schemeSet3
          });

          initPieChart.draw({
            data: getBeneficiaryScoresForPieChart(),
            colors: beneficiaryColors,
            element: 'beneficiary-pie'
          });

          fegsScopingView.displayBeneficiaryScores(); // update #table-beneficiary-score
        }

        updateBeneficiaryProgress();
        tableAttributes.showOnlyTheseColumns(fegsScopingData.extantBeneficiaries());
        fegsScopingData.clearOtherAttributes(fegsScopingData.extantBeneficiaries());
      };

      for (i = tBody.rows[0].cells.length - 1; i > 2; i--) { // remove all data columns
        removeLastColumnFromTable(table.id);
      }
      if (select.selectedIndex === 0) { // default selection => do nothing further
        return;
      }
      addTableColumn(table.id, stakeholderName, fegsScopingData.fegsBeneficiaries); // add a column to house the data
      for (rowIndex = 0; rowIndex < tBody.rows.length; rowIndex++) {
        cell = tBody.rows[rowIndex].cells[tBody.rows[rowIndex].cells.length - 1];
        if (!fegsScopingData.stakeholders[stakeholderName] || !('beneficiaries' in fegsScopingData.stakeholders[stakeholderName])) { // create empty inputs for beneficiaries that are not scored for a stakeholder yet
          cell.innerHTML = '';
          input = document.createElement('input');
          input.type = 'number';
          input.className = 'beneficiary-percentage-of-stakeholder';
          cell.appendChild(input);
          input.oninput = beneficiaryPercentageOfStakeholderInputValidator;
          continue;
        }
        if (tBody.rows[rowIndex].cells[0].getAttribute('rowspan') === null) { // check for spanned row-header
          numberOfBeneficiaryColumnsInRow = 0;
        } else {
          numberOfBeneficiaryColumnsInRow = 1;
        }
        beneficiaryName = tBody.rows[rowIndex].cells[tBody.rows[rowIndex].cells.length - 1].innerText;
        cell.innerHTML = '';
        input = document.createElement('input');
        input.type = 'number';
        input.className = 'beneficiary-percentage-of-stakeholder';
        if (fegsScopingData.stakeholders[stakeholderName].beneficiaries[beneficiaryName] &&
          fegsScopingData.stakeholders[stakeholderName].beneficiaries[beneficiaryName].hasOwnProperty('percentageOfStakeholder')) {
          input.value = fegsScopingData.stakeholders[stakeholderName]
            .beneficiaries[beneficiaryName]
            .percentageOfStakeholder;
        }
        input.oninput = beneficiaryPercentageOfStakeholderInputValidator; // save valid input
        cell.appendChild(input);
      }
      tableAttributes.showOnlyTheseColumns(fegsScopingData.extantBeneficiaries());
      updateBeneficiaryProgress();
    };

    /**
     * Populate test data to verify calculations
     * Access data as fegsScopingData.stakeholders['foo']
     *                               .beneficiaries['Irrigators']
     *                               .attributes['Weather']
     */
    var prepopulatedData = function() {
      var literal = {
        'stakeholders': {
          'Residents': {
            'scores': {
              'magnitude': '40',
              'influence': '100',
              'interest': '25',
              'urgency': '0',
              'proximity': '75',
              'economic-interest': '100',
              'rights': '100',
              'fairness': '100',
              'representation': '100'
            },
            'beneficiaries': {
              'Farmers': {
                'percentageOfStakeholder': '20',
                'attributes': {
                  'Weather': '15',
                  'Air': '5',
                  'Soil': '15',
                  'Water': '25',
                  'Fungi': '25',
                  'Polinators': '10',
                  'Depredators and (Pest) Predators': '5'
                }
              },
              'Timber / Fiber / Ornamental extractors': {
                'percentageOfStakeholder': '25'
              },
              'Military / Coast Guard': {
                'percentageOfStakeholder': '2'
              },
              'Water subsisters': {
                'percentageOfStakeholder': '3'
              },
              'Students and educators': {
                'percentageOfStakeholder': '30'
              },
              'People who care (existence)': {
                'percentageOfStakeholder': '10'
              },
              'People who care (option, bequest)': {
                'percentageOfStakeholder': '10'
              }
            },
          },
          'Timber Industry': {
            'scores': {
              'magnitude': '60',
              'influence': '50',
              'interest': '75',
              'urgency': '60',
              'proximity': '100',
              'economic-interest': '100',
              'rights': '60',
              'fairness': '0',
              'representation': '0'
            },
            'beneficiaries': {
              'Timber / Fiber / Ornamental extractors': {
                'percentageOfStakeholder': '100'
              }
            }
          },
          'Fishing and Crabbing Industry': {
            'scores': {
              'magnitude': '60',
              'influence': '50',
              'interest': '75',
              'urgency': '60',
              'proximity': '100',
              'economic-interest': '100',
              'rights': '60',
              'fairness': '0',
              'representation': '0'
            },
            'beneficiaries': {
              'Food extractors': {
                'percentageOfStakeholder': '100'
              }
            }
          }
        },
        'attributes': {
          'Farmers': {
            'Weather': '15',
            'Air': '5',
            'Water': '15',
            'Soil': '25',
            'Fungi': '25',
            'Pollinators': '10'
          },
          'Food extractors': {
            'Fauna': '100'
          },
          'Timber / Fiber / Ornamental extractors': {
            'Flora': '100'
          },
          'Military / Coast Guard': {
            'Water': '100'
          },
          'Water subsisters': {
            'Water': '100'
          },
          'Students and educators': {
            'Sounds and Scents': '10',
            'Viewscapes': '50',
            'Open Space': '10',
            'Presence of the Environment': '30',
          },
          'People who care (existence)': {
            'Sounds and Scents': '10',
            'Viewscapes': '50',
            'Open Space': '10',
            'Presence of the Environment': '30',
          },
          'People who care (option, bequest)': {
            'Sounds and Scents': '10',
            'Viewscapes': '50',
            'Open Space': '10',
            'Presence of the Environment': '30',
          },
        }
      };
      var data = new FEGSScopingData();
      data.attributes = JSON.parse(JSON.stringify(literal.attributes));
      data.stakeholders = JSON.parse(JSON.stringify(literal.stakeholders));
      return data;
    };

    /**
     * Populate sample data into app for development.
     * Access data as fegsScopingData.stakeholders['foo']
     *                               .beneficiaries['Irrigators']
     *                               .attributes['Weather']
     */
    var populateDevData = function(stakeholderNames) {
      if (typeof(stakeholderNames) === 'undefined') {
        var stakeholderNames = ['foo', 'bar', 'baz', 'qux'];
      }
      for (var i = 0; i < stakeholderNames.length; i++) {
        var stakeholderName = stakeholderNames[i];
        var beneficiarySlices = [];
        var iBen, iAttr;
        var benSum = 0;
        var sliceSum = 0;
        var attrSum = 0;
        var normalizedSlice;
        var unnormalizedPercentages = [];
        var AttributesObject = {};
        fegsScopingData.addStakeholder(stakeholderName, fegsScopingData.makeCriteriaObject({}));
        for (iBen = 0; iBen < fegsScopingData.fegsBeneficiaries.length; iBen++) {
          beneficiarySlices.push(Math.random());
          benSum += beneficiarySlices[iBen];
        }
        for (iBen = 0; iBen < fegsScopingData.fegsBeneficiaries.length; iBen++) {
          normalizedSlice = parseFloat(round((beneficiarySlices[iBen] * benSum ** -1 * 100), 2));
          fegsScopingData.addBeneficiary(stakeholderName, fegsScopingData.fegsBeneficiaries[iBen], normalizedSlice);
          attrSum = 0;
          for (iAttr = 0; iAttr < fegsScopingData.fegsAttributes.length; iAttr++) {
            AttributesObject[fegsScopingData.fegsAttributes[iAttr]] = Math.random();
            attrSum += AttributesObject[fegsScopingData.fegsAttributes[iAttr]];
          }
          for (iAttr = 0; iAttr < fegsScopingData.fegsAttributes.length; iAttr++) {
            AttributesObject[fegsScopingData.fegsAttributes[iAttr]] = AttributesObject[fegsScopingData.fegsAttributes[iAttr]] * attrSum ** -1 * 100;
          }
          fegsScopingData.addAttributes(stakeholderName, fegsScopingData.fegsBeneficiaries[iBen], AttributesObject);
        }
        for (iBen = 0; iBen < fegsScopingData.fegsBeneficiaries.length - 1; iBen++) {
          normalizedSlice = parseFloat(round((beneficiarySlices[iBen] * benSum ** -1 * 100), 2));
          sliceSum += normalizedSlice;
          fegsScopingData.stakeholders[stakeholderName]
            .beneficiaries[fegsScopingData.fegsBeneficiaries[iBen]]
            .percentageOfStakeholder = normalizedSlice;
        }
        fegsScopingData.stakeholders[stakeholderName]
          .beneficiaries[fegsScopingData.fegsBeneficiaries[fegsScopingData.fegsBeneficiaries.length - 1]]
          .percentageOfStakeholder = round((100 - sliceSum), 2);
      };
      return fegsScopingData;
    };

    var testy = function() {
      var select = document.getElementById('select-stakeholder');
      var stakeholdersArray;
      populateDevData();
      stakeholdersArray = Object.keys(fegsScopingData.stakeholders);
      for (var i = 0; i < stakeholdersArray.length; i++) {
        addOption('select-stakeholder', stakeholdersArray[i], stakeholdersArray[i]);
      }
      select.selectedIndex = 1;
      selectStakeholderToSlice();
    };

    /** clean trailing empty cells from each row then remove last cell from each row */
    var removeLastColumnFromTable = function(tableId) {
      table = document.getElementById(tableId);
      for (var i = 0; i < table.rows.length; i++) {
        for (var j = 0; j < table.rows[i].cells.length; j++) {
          if (table.rows[i].cells[table.rows[i].cells.length - 1].innerHTML.trim() === '') {
            table.rows[i].cells[table.rows[i].cells.length - 1].remove(); // trim blank trailing cells
          }
        }
        table.rows[i].cells[table.rows[i].cells.length - 1].remove(); // remove leftmost cell of data
      }
    };

    /** remove options with text of optionText from selectid */
    var removeOptionFromSelect = function(selectId, optionText) {
      select = document.getElementById(selectId);
      if (select.options[select.selectedIndex].text === optionText) { // is the option to be removed selected?
        select.selectedIndex = 0; // if selected => select default option
      }
      for (var i = 0; i < select.options.length; i++) { // remove option
        if (optionText === select.options[i].text) {
          select.options[i].remove();
        }
      }
      select.onchange(); // fire select's onchange callback
    };

    /** refresh select-box from data */
    var updateSelectStakeholder = function(selectId) {
      var i;
      var select = document.getElementById(selectId);
      var stakeholderNames = Object.keys(fegsScopingData.stakeholders);
      for (i = select.options.length - 1; i > 0; i--) { // remove all options
        select.options[i].remove();
      }
      for (i = 0; i < stakeholderNames.length; i++) { // add option for each stakeholder
        addOption(selectId, stakeholderNames[i], stakeholderNames[i]);
      }
      selectStakeholderToSlice();
    };

    /** return HTMLElement of accessible notice of text */
    var accessiblyNotify = function(text) {
      var notices = document.getElementsByClassName('accessible-notification');
      var notice = document.createElement('div');
      var textNode = document.createTextNode(text);
      clearNotices();
      notice.appendChild(textNode);
      notice.setAttribute('aria-live', 'polite');
      notice.addEventListener('click', function() {
        this.remove()
      });
      notice.className = 'accessible-notification';
      document.getElementsByTagName('body')[0].appendChild(notice);
      return notice;
    };

    /** clear all notices */
    var clearNotices = function() {
      var notices = document.getElementsByClassName('accessible-notification');
      for (var i = 0; i < notices.length; i++) {
        notices[i].remove();
      }
    };

    var tablesome = function(columnNames, rowNames) {
      var mapString = function(inputString) {
        return inputString.toLocaleLowerCase().replace(/[^a-zA-Z0-9]$/, '').replace(/[ -/(]+/g, '-');
      };
      var mapper = function(arrayOfNames) {
        var map = {};
        for (var i = 0; i < arrayOfNames; i++) {
          map[arrayOfNames[i]] = {
            'id': mapString(columnNames[i]),
            'number': i,
          }
        }
        return map;
      };
      if (typeof(columnNames) !== 'undefined') {
        columnMap = mapper(columnNames);
      }
      if (typeof(rowNames) !== 'undefined') {
        rowMap = mapper(rowNames);
      }
      console.log('invoked tablesome()');
      return [columnMap, rowMap];
    };

    /** exemplify testing to a spec on the function that
     *   digests data to cleanse ugly characters
     */
    var tablesomeSpec = function(tablesome) { // a spec is a set of tests that define an API
      // sanitize arrays in url-friendly ways
      console.log('expecting', 'foo-bar-baz-qux');
      console.log("tablesome(['Foo - Bar/Baz(Qux)'], ['Foo - Bar/Baz(Qux)']):");
      console.log(tablesome(['Foo - Bar/Baz(Qux)'], ['Foo - Bar/Baz(Qux)']));
      return tablesome(['Foo- Bar / Baz(Qux )'], ['Foo - Bar/Baz (Qux)']) === [
        ['foo-bar-baz-qux'],
        ['foo-bar-baz-qux']
      ]; // should do something like array.replace(/\s*[-/\)\(]*\s*/, '-')
    };

    /**
     * interface cells indexed by row- and column-headers
     * @param {string} tableId - id of table to interface
     * @param {string[]} rowHeaders - headers of rows
     * @param {string[]} columnHeaders - headers of columns
     * @param {number} rowOffset - offset for tHead
     * @param {number} columnOffset - offset for header in row
     * @property {function} cell - return the HTMLElemtent of
     *  the cell specified by its row-header and column-header
     * @property {function} test - test the arrays of column-
     *  and row-headers against the table's headers
     */
    var Table = function(tableId, rowHeaders, columnHeaders, rowOffset, columnOffset) {
      this.id = tableId;
      this.rowHeaders = rowHeaders;
      this.columnHeaders = columnHeaders;
      this.rowOffset = rowOffset;
      this.columnOffset = columnOffset;
      this.table = document.getElementById(tableId);
      this.hiddenClassName = 'display-none';
      this.spannedHeaders = this.table.rows[0].cells
      this.colSpanOriginalValuePropertyName = 'data-colspan-original-value';
      this.cols = this.table.querySelectorAll('col');
      this.colCells = this.table.rows[0].cells;

      /** populate given data into columns */
      this.populateAttributeData = function() {
        console.log("populateAttributeData");
        var stakeholder = fegsScopingController.getCurrentStakeholder();
        var rowIndex;
        if (!fegsScopingView.stakeholderIsSelected() || this.id !== 'table-attributes') {
          return;
        }
        for (columnIndex in this.columnHeaders) { // cycle through beneficiaries
          beneficiary = this.columnHeaders[columnIndex];
          if (this.isHidden(this.columnHeaders[columnIndex])) {
            continue;
          }
          for (rowIndex = 0; rowIndex < this.rowHeaders.length; rowIndex++) { // cycle through attributes
            attribute = this.rowHeaders[rowIndex];
            console.log('beneficiary: ', beneficiary);
            console.log('attribute: ', attribute);
            console.log('this.isHidden(' + beneficiary + '): ', this.isHidden(beneficiary));
            console.log('fegsScopingData.stakeholders[stakeholder].beneficiaries[beneficiary].attributes[attribute]: ', fegsScopingData.stakeholders[stakeholder].beneficiaries[beneficiary].attributes[attribute]);
            this.cellInputValue(this.cell(attribute, beneficiary), fegsScopingData.stakeholders[stakeholder].beneficiaries[beneficiary].attributes[attribute].percentageOfBeneficiary); // set value of input in cell FIXME SET INPUT VALUE
          }
        }
      };

      /** store an element's initial span in a uniformly named property of the element */
      this.storeInitialSpanOfCols = function storeInitialSpanOfCols() {
        var iCol;
        for (iCol = 0; iCol < this.cols.length; iCol++) {
          this.cols[iCol].setAttribute(this.colSpanOriginalValuePropertyName, this.cols[iCol].span);
        }
      };

      /** return the specified cell */
      this.cell = function(rowHeader, columnHeader) {
        var rowIndex = rowHeaders.indexOf(rowHeader) + this.rowOffset;
        var columnIndex = columnHeaders.indexOf(columnHeader) + this.columnOffset;
        return this.table.rows[rowIndex].cells[columnIndex];
      };

      /** test the table's construction */
      this.test = function() {
        var rowHeaderColumnNumber = 0;
        var columnHeaderRowNumber = 1;
        var errors = [];
        var i;
        for (i = 0; i < rowHeaders.length; i++) { // test rowHeaders
          if (rowHeaders[i] !== this.table.rows[i + rowOffset].cells[rowHeaderColumnNumber].innerText) {
            errors.push(new Error('rowHeaders mismatch: ' + rowHeaders[i] + ' does not match ' + this.table.rows[i + rowOffset].cells[rowHeaderColumnNumber].innerText));
          }
        }
        for (i = 0; i < columnHeaders.length; i++) { // test columnHeaders
          if (columnHeaders[i] !== this.table.rows[columnHeaderRowNumber].cells[columnOffset + i].innerText) {
            errors.push(new Error('columnHeaders mismatch: ' + columnHeaders[i] + ' does not match ' + this.table.rows[columnHeaderRowNumber].cells[columnOffset + i].innerText));
          }
        }
        return errors;
      };

      /** return table's cells in an array of arrays */
      this.cells = function() {
        var cells = [];
        for (i = 0; i < this.table.rows.length; i++) {
          if (typeof(cells[i]) === 'undefined') {
            cells[i] = [];
          }
          for (j = 0; j < this.table.rows[i]; j++) {
            cells[i][j] = this.table.rows[i].cells[j];
          }
        }
        return cells;
      };

      /**
       * get or set value of the input in the supplied cell
       * @param {td or th object} cell - supplied cell containing an input-element
       * @param {string} setterValue - specifies the value to set the input to when present
       */
      this.cellInputValue = function(cell, setterValue) { // setterValue is optional parameter to make this a setter
        if (typeof(setterValue) === 'undefined') {
          return cell.getElementsByTagName('input')[0].value;
        } else { // if setterValue is present then set the input's value to setterValue
          cell.getElementsByTagName('input')[0].value = setterValue;
        }
      };

      /** get index of indicated column assuming numerical args are indices */
      this.getColumnIndex = function(columnIndicator) {
        if (isNaN(columnIndicator) || Number('1') !== Math.round(Number('1'))) { // assume the argument is a heading-string if not coercible to NaN
          unshiftedColumnIndex = this.columnHeaders.indexOf(columnIndicator);
          if (unshiftedColumnIndex === -1) {
            throw new Error('columnIndicator not found: ' + columnIndicator + 'in Table-instance ', this);
          }
          return unshiftedColumnIndex + this.columnOffset;
        } else { // assume a numerical index was supplied if not coerced to NaN
          return columnIndicator;
        }
      };

      /** true if the indicated column is hidden else false */
      this.isHidden = function(columnIndicator) {
        return this.table.rows[1].cells[this.getColumnIndex(columnIndicator)].classList.contains(this.hiddenClassName);
      };

      /** true if the indicated col is hidden else false */
      this.isColHidden = function(colIndicator) {
        var colIndex;
        if (+colIndicator === NaN) {
          colIndex = this.cols.indexOf(colIndicator);
        } else {
          colIndex = colIndicator;
        }
        return this.cols[colIndex].classList.contains(this.hiddenClassName);
      };

      /** get index of col containing the indicated column */
      this.getColIndex = function(columnIndicator) {
        var columnIndex = this.getColumnIndex(columnIndicator);
        var currentColOriginalSpan;
        var colIndex = 0;
        var colSpanIndex = 0;
        for (colIndex = 0; colIndex < this.cols.length; colIndex++) {
          currentColOriginalSpan = parseFloat(this.cols[colIndex].getAttribute(this.colSpanOriginalValuePropertyName));
          if (colSpanIndex + currentColOriginalSpan > columnIndex) {
            return colIndex; // colIndex was the index of the col containing the indicated column
          } else {
            colSpanIndex += currentColOriginalSpan;
          }
        }
      };

      /** get name of indicated column */
      this.getColumnName = function(columnIndicator) {
        var columnIndex = this.getColumnIndex(columnIndicator);
        return this.table.rows[rowOffset - 1].cells[columnIndex].innerText;
      };

      /** clear indicated column */
      this.clearColumn = function(columnIndicator) {
        var rowIndex;
        var columnIndex = this.getColumnIndex(columnIndicator);
        for (rowIndex = 1; rowIndex < this.table.rows.length; rowIndex++) {
          if (this.table.rows[rowIndex].cells[columnIndex].querySelector('input')) {
            this.table.rows[rowIndex].cells[columnIndex].querySelector('input').value = '';
          }
        }
      };

      /** hide columns up to that indicated */
      this.hideColumnsUpTo = function(columnIndicator) {
        var targetColumnIndex = this.getColumnIndex(columnIndicator);
        var currentColumnIndex;
        for (currentColumnIndex = columnOffset; currentColumnIndex < targetColumnIndex; currentColumnIndex++) {
          this.hideColumn(currentColumnIndex);
        }
      };

      /** hide indicated column */
      this.hideColumn = function(columnIndicator) {
        var rowIndex;
        var columnIndex = this.getColumnIndex(columnIndicator);
        var colIndex = this.getColIndex(columnIndex);
        if (this.isHidden(columnIndex)) {
          return;
        }
        if (this.cols[colIndex].span === 1) { // hide col and its labelling headers if this is last column
          this.cols[colIndex].classList.add(this.hiddenClassName);
          this.colCells[colIndex].classList.add(this.hiddenClassName);
        } else { // decrement span and colspan
          this.cols[colIndex].span -= 1;
          this.colCells[colIndex].colSpan -= 1;
        }
        for (rowIndex = 1; rowIndex < this.table.rows.length; rowIndex++) {
          this.table.rows[rowIndex].cells[columnIndex].classList.add(this.hiddenClassName);
        }
      };

      /** show indicated column */
      this.showColumn = function(columnIndicator) {
        var rowIndex;
        var columnIndex = this.getColumnIndex(columnIndicator);
        var colIndex = this.getColIndex(columnIndex);
        if (!this.isHidden(columnIndex)) { // do nothing if already shown
          return;
        }
        if (!this.isColHidden(colIndex)) { // increment span and colspan
          this.cols[colIndex].span += 1;
          this.colCells[colIndex].colSpan += 1;
        }
        if (this.cols[colIndex].span === 1) { // show col and its labelling headers if this is the first visible column in col
          this.cols[colIndex].classList.remove(this.hiddenClassName);
          this.colCells[colIndex].classList.remove(this.hiddenClassName);
        }
        for (rowIndex = 1; rowIndex < this.table.rows.length; rowIndex++) {
          this.table.rows[rowIndex].cells[columnIndex].classList.remove(this.hiddenClassName);
        }
      };

      /** show only specified columns */
      this.showOnlyTheseColumns = function(columnIndicators) {
        columnIndicators = (typeof columnIndicators !== 'undefined') ? columnIndicators : [];
        var columnIndices = [];
        for (var i = 0; i < columnIndicators.length; i++) {
          columnIndex = this.getColumnIndex(columnIndicators[i]);
          this.showColumn(columnIndex);
          columnIndices.push(columnIndex);
        }
        for (var i = 2; i < this.table.rows[1].cells.length; i++) {
          if (columnIndices.indexOf(i) === -1) {
            this.clearColumn(i);
            this.hideColumn(i);
          }
        }
      };

      this.showAttributeScores = function() {
        this.showColumn("Attribute Score");
        for (var i = 0; i < this.rowHeaders.length; i++) {
          this.cell(this.rowHeaders[i], "Attribute Score").innerHTML = fegsScopingData.calculateAttributeScore(this.rowHeaders[i]);
        }
      };

      this.hideRow = function(rowIndicator) {
        //TODO fill in stub s.t. rowIndicator can be a numerical index or a header-name
      };

      this.showRow = function(rowIndicator) {
        //TODO fill in stub s.t. rowIndicator can be a numerical index or a header-name
      };

      ////////////////// Table'S PROCESS ////////////////////
      this.storeInitialSpanOfCols();
      var cell;
      for (i = 0; i < this.table.rows.length; i++) {
        for (j = 0; j < this.table.rows[i].cells.length; j++) {
          cell = this.table.rows[i].cells[j];
          if (cell.colSpan > 1) {
            cell.setAttribute(this.colSpanOriginalValuePropertyName, cell.colSpan);
          }
        }
      }
    }; ////// END PROTOTYPE NAMED Table ////////////

    /** instantiate a Table() for #table-attributes; perform specialized initializations */
    var tableAttributesCreator = function(tableId) {
      var rowOffset = 3; // introduce fragility by duplicating initializion via literal or break the callback's encapsulation?
      var columnOffset = 3; // introduce fragility by duplicating initializion via literal or break the callback's encapsulation?
      var rowNames = fegsScopingData.fegsAttributes;
      var columnNames = fegsScopingData.fegsBeneficiaries;
      var table = new Table(tableId, rowNames, columnNames, rowOffset, columnOffset);
      var cell;

      var validateAndSaveData = function() {
        var columnIndex = this.parentElement.cellIndex;
        var beneficiaryName = fegsScopingData.fegsBeneficiaries[columnIndex - columnOffset];
        var allBlank = true;
        var attributesObject = {};
        var sum = 0; // sum all cells to see if sum is correctly normalized
        var rows = this.parentElement.parentElement.parentElement.rows;
        var rowIndex;
        var input;
        if (this.value < 0 || this.value > 100) { // value is invalid after change
          for (i = 0; i < rows.length; i++) {
            rows[i].cells[columnIndex].classList.remove('invalid-text-input');
          }
          this.parentElement.classList.add('invalid-text-input');
          accessiblyNotify('Attribute ' + rows[this.parentElement.parentElement.rowIndex].cells[0].innerText + ' was input as ' + this.value + ' percent of beneficiary-group ' + document.getElementById('table-attributes').rows[1].cells[this.parentElement.cellIndex].innerText + '. Percentages must be between 0 and 100.');
        } else { // individual input is valid
          for (i = 0; i < rows.length; i++) { // loop through values in column
            if (allBlank === true && rows[i].cells[columnIndex].getElementsByTagName('input')[0].value !== '') {
              allBlank = false;
            }
            sum += +rows[i].cells[columnIndex].getElementsByTagName('input')[0].value;
          }
          if (allBlank === true || String(sum) === '100') { // pecentages are correctly normalized
            clearNotices(); // clear notices which describe bad input
            for (i = 0; i < rows.length; i++) { // clear styling indicating bad input
              rows[i].cells[columnIndex].classList.remove('invalid-text-input');
            }
            for (rowIndex = 0; rowIndex < rows.length; rowIndex++) {
              rows[rowIndex].cells[columnIndex].classList.remove('invalid-text-input');
              attributeName = fegsScopingData.fegsAttributes[rowIndex];
              attributesObject[attributeName] = rows[rowIndex].cells[columnIndex].getElementsByTagName('input')[0].value;
            }
            fegsScopingData.addAttributes(beneficiaryName, attributesObject); // save
            tableAttributes.showOnlyTheseColumns(fegsScopingData.extantBeneficiaries()); // update beneficiaries shown in #table-attributes
            fegsScopingView.indicateUnsaved();
          } else { // notify of incorrect normalization
            accessiblyNotify('The percentages for beneficiary ' + beneficiaryName + ' sum to ' + sum + '.  Percentages must sum to 100.');
            for (i = 0; i < rows.length; i++) {
              rows[i].cells[columnIndex].classList.add('invalid-text-input');
            }
          }
        }
        updateAttributeProgress();
        initPieChart.draw({
          data: getAttributeScoresForPieChart(),
          colors: beneficiaryColors,
          element: 'attribute-pie'
        });

        initBarChart.draw({
          data: getAttributeScoresForPieChart(),
          element: 'attribute-barchart',
          colors: d3.schemeSet3
        });
      };

      for (var i = 0; i < rowNames.length; i++) {
        for (var j = 0; j < columnNames.length; j++) {
          //TODO implement excel-compatible keyboard-navigation listeners
          cell = table.cell(rowNames[i], columnNames[j]);
          if (cell.querySelector('input') === null) {
            input = document.createElement('input');
            input.type = 'number';
            cell.appendChild(input); // store data and set properties including callbacks before insertion into DOM to optimize performance
          } else {
            input = cell.querySelector('input');
          }
          input.oninput = validateAndSaveData; // apply onchange callback late to restore functionality
        }
      }
      table.table.setAttribute('data-initialized', "true");
      return table;
    };

    /** Prototype view to encapsulate representation. */
    var FEGSScopingView = function() {

      /** initialize the view of the application */
      this.initializeView = function() {
        this.showName.style.display = 'inline-block';
        //this.changeNameButton.style.display = 'inline-block';
        //this.inputName.style.display = 'none';
        this.saveNameButton.style.display = 'none';
        this.projectName = fegsScopingData.projectName;
        this.projectNameMenu.innerHTML = this.projectName;
      };

      /** update name displayed in titlebar and header */
      this.updateName = function(name) {
        this.projectNameMenu.innerHTML = name; // update the name shown
        this.projectName = name; // update the name of the view
        this.title = name; // call the name a title, too
        this.showName.style.display = 'inline-block';
        //this.changeNameButton.style.display = 'inline-block';
        this.inputName.style.display = 'none';
        this.saveNameButton.style.display = 'none';
      };

      /** input the name of this project */
      this.editName = function() {
        this.showName.style.display = 'none';
        //this.changeNameButton.style.display = 'none';
        this.inputName.style.display = 'inline-block';
        this.saveNameButton.style.display = 'inline-block';
        this.inputName.value = this.projectNameMenu.innerText;
      };

      /** save the name of this project */
      this.saveNameButton = function() {
        this.inputName.style.display = 'none';
        this.saveNameButton.style.display = 'none';
        this.showName.style.display = 'inline-block';
        this.changeName.style.display = 'inline-block';
        this.projectNameMenu.innerText = inputName.value;
        fegsScopingController.saveValidatedData();
        this.projectName = inputName.value;
      };

      /** restore view's state: each input with a stored value restores that value */
      this.restoreView = function(filename) {
        console.log("restoreView")
        if (typeof(filename) === 'undefined') {
          filename = 'data.json'
        }
        var criterion;
        fegsScopingData = fegsScopingController.importData(filename);
        fegsScopingController.updateName(fegsScopingData.projectName);
        for (i = 0; i < fegsScopingData.criteria.length; i++) {
          criterion = fegsScopingData.criteria[i];
          document.querySelector('#' + criterion + '-score').value = fegsScopingData.scores[criterion];
        }
        initPieChart.draw({
          data: getScores(), // Get the score data
          colors: criteriaColors,
          element: 'criteria-pie',
          inputClass: 'scoring'
        });

        document.getElementById("beneficiary-charts").removeAttribute('hidden');
        initStackedBarChart.draw({
          data: formatBeneficiaryData(),
          key: Object.keys(fegsScopingData.stakeholders),
          legend: Object.keys(fegsScopingData.stakeholders),
          element: 'beneficiary-barchart',
          header: 'beneficiary',
          colors: d3.schemeSet3
        });

        initPieChart.draw({
          data: getBeneficiaryScoresForPieChart(),
          colors: beneficiaryColors,
          element: 'beneficiary-pie'
        });

        initPieChart.draw({
          data: getAttributeScoresForPieChart(),
          colors: beneficiaryColors,
          element: 'attribute-pie'
        });

        initBarChart.draw({
          data: getAttributeScoresForPieChart(),
          element: 'attribute-barchart',
          colors: d3.schemeSet3
        });

        fegsScopingView.showStakeholderScores();
        fegsScopingView.displayBeneficiaryScores();
        fegsScopingView.restoreAttributes();

        updateStakeholderProgress();
        updateWeightingProgress();
        updateBeneficiaryProgress();
        updateAttributeProgress();

        //TODO FIXME LOAD DATA ABOVE HERE ^ ^ ^ ^ ^ ^ ^
        fegsScopingView.indicateSaved();
      };

      /** indicate saved status */
      this.indicateSaved = function() {
        document.title = fegsScopingData.projectName;
        document.getElementById('unsaved-indicator').setAttribute("hidden" , "");
      };

      /** indicate unsaved status */
      this.indicateUnsaved = function() {
        document.title = fegsScopingData.projectName + '*';
        document.getElementById('unsaved-indicator').removeAttribute("hidden");
      };

      /** save view's state: each input stores its own data */
      this.saveView = function() {
        var i;
        var inputs = document.querySelectorAll('input:not([type="radio"])');
        var radioInputs = document.querySelectorAll('input[type="radio"]');
        for (i = 0; i < inputs.length; i++) {
          inputs[i].setAttribute('data-value', inputs[i].value);
        }
        for (i = 0; i < radioInputs.length; i++) {
          radioInputs[i].setAttribute('data-checked', radioInputs[i]['checked']);
        }
        document.body.setAttribute('data-restore', 'true'); // set flag to automatically restore data on document load
      };

      this.pages = document.querySelectorAll('.page');
      var self = this;
      /** show only the identified page */
      this.focusPage = function(pageId) {
        var pages = document.querySelectorAll('.page');
        var pageIndex;
        for (pageIndex = 0; pageIndex < pages.length; pageIndex++) {
          if (pages[pageIndex].id === pageId) {
            pages[pageIndex].style.display = 'block';
          } else {
            pages[pageIndex].style.display = 'none';
          }
        }
        self.ensureNavigability(pageId);
      };

      /** add navigability if absent */
      this.ensureNavigability = function(pageId) {
        var navigation;
        var back;
        var forward;
        if (!document.getElementById(pageId).querySelector('.navigation')) {
          navigation = document.createElement('div');
          navigation.setAttribute('class', 'navigation');
          back = document.createElement('button');
          forward = document.createElement('button');
          back.innerHTML = 'back';
          forward.innerHTML = 'forward';
          back.onclick = function() {
            var pages = document.querySelectorAll('.page');
            var pageIndex;
            var currentPageIndex;
            for (pageIndex = 0; pageIndex < pages.length; pageIndex++) {
              if (pages[pageIndex].style.display === 'block') {
                currentPageIndex = pageIndex;
                break;
              }
            }
            if (currentPageIndex > 0) {
              self.focusPage(pages[currentPageIndex - 1].id)
            } else {
              console.log('there is no page before the first page');
            }
          };
          forward.onclick = function() {
            var pages = document.querySelectorAll('.page');
            var currentPage = document.querySelector('.page[display="block"]');
            var pageIndex;
            var currentPageIndex;
            for (pageIndex = 0; pageIndex < pages.length; pageIndex++) {
              if (pages[pageIndex].style.display === 'block') {
                currentPageIndex = pageIndex;
                break;
              }
            }
            if (currentPageIndex < pages.length - 1) {
              self.focusPage(pages[currentPageIndex + 1].id)
            } else {
              console.log('there is no page after the last page');
            }
          };
          navigation.appendChild(back);
          navigation.appendChild(forward);
          document.getElementById(pageId).appendChild(navigation);
        }
      };

      this.showStakeholderScores = function() {
        console.log("showStakeholderScores")
        for (var stakeholder in fegsScopingData.stakeholders) {
          addRow('table-stakeholders', [stakeholder, fegsScopingData.stakeholders[stakeholder]]); // table name and array of values to insert
        }
        document.getElementById('set-stakeholder-values').style.display = "none";
        document.getElementById('stakeholder-list').style.display = "none";
        clearStakeholderScores();
        initStackedBarChart.draw({
          data: formatStakeholderData(),
          key: fegsScopingData.criteria,
          element: 'stakeholder-barchart',
          header: 'stakeholder',
          colors: criteriaColors
        });
        updateSelectStakeholder('select-stakeholder');
        document.getElementById('select-stakeholder').onchange();
        updateStakeholderProgress();
        document.getElementById('stakeholder-table-container').style.display = "block";
        fegsScopingView.indicateUnsaved();
      };

      this.getCurrentStakeholder = function() {
        return document.querySelector('#select-stakeholder').value;
      };

      this.stakeholderIsSelected = function() {
        return Boolean(document.querySelector('#select-stakeholder').selectedIndex);
      };

      /** caculate and display beneficiary-scores */
      this.displayBeneficiaryScores = function() {
        var table = tableAttributes;
        var columnNames = fegsScopingData.extantBeneficiaries();
        var rowNames = ["Beneficiary Score"];
        var cell;
        var cellValue;
        for (var i = 0; i < columnNames.length; i++) {
          cell = table.cell(rowNames[0], columnNames[i]);
          cellValue = fegsScopingData.beneficiaryScore(columnNames[i]);
          if (isNaN(cellValue)) {
            cellValue = 0;
          }
          if (cellValue === 0) {
            table.hideColumn(columnNames[i]);
          } else {
            table.showColumn(columnNames[i]);
          }
          cell.innerText = round(cellValue, 2);
        }
      };

      this.restoreAttributes = function() {
        var table = tableAttributes;
        var rowNames = table.rowHeaders;
        var columnNames = table.columnHeaders;
        var cell;

        for (var i = 0; i < rowNames.length; i++) {
          for (var j = 0; j < columnNames.length; j++) {
            if (fegsScopingData.attributes.hasOwnProperty(columnNames[j])) {
              table.showColumn(columnNames[j]);
              cell = table.cell(rowNames[i], columnNames[j]);
              if (cell.querySelector('input') === null) {
                input = document.createElement('input');
                input.type = 'number';
                cell.appendChild(input);
              } else {
                input = cell.querySelector('input');
              }
              input.value = fegsScopingData.attributes[columnNames[j]][rowNames[i]].percentageOfBeneficiary;
            }
          }
        }
      };

      //////////// PROCESS IN PROTOTYPE FEGSScopingView ///////////////

      this.inputName = document.getElementById('input-name');
      this.showName = document.getElementById('show-name');
      this.projectNameMenu = document.getElementById('menu-project-name');
      this.saveNameButton = document.getElementById('save-name');
      this.changeNameButton = document.getElementById('change-name');
      this.initializeView();
    }; ////////////// END PROTOTYPE FEGSScopingView /////////////////////

    function toggleTableDefinitions(event, tableID) {
      for (var i = 0; i < document.querySelectorAll('#' + tableID + ' .definition').length; i++) {
        var element = document.querySelectorAll('#' + tableID + ' .definition')[i];
        if (element.hasAttribute('hidden') || element.classList.contains('display-none')) {
          event.target.innerHTML = 'Hide definitions';
          element.removeAttribute('hidden');
          element.classList.remove('display-none');
        } else {
          event.target.innerHTML = 'Show definitions';
          element.setAttribute('hidden', true);
          element.classList.add('display-none');
        }
      }
    }

    var getDocument = function() {
      var documentText = '<!DOCTYPE html>' + '\n' + document.documentElement.outerHTML;
      return documentText;
    }

    var downloadText = function(filename, text) {
      console.log("downloadText")
      var element = document.createElement('a');
      element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
      element.setAttribute('download', filename);

      element.style.display = 'none';
      document.body.appendChild(element);

      element.click();

      document.body.removeChild(element);
    }

    ////////// PAGE-PROCESS //////////////////////////////////////
    var fegsScopingData = new FEGSScopingData();
    var fegsScopingView = new FEGSScopingView();
    var fegsScopingController = new FEGSScopingController();
    var criteriaColors = ["#4f81bd", "#c0504d", "#9bbb59", "#8064a2", "#4bacc6", "#f79646", "#2c4d75", "#772c2a", "#5f7530"];
    var beneficiaryColors = ["#DDD9C3", "#C4BD97", "#948A54", "#948A54", "#4A452A", "#1E1C11", "#050503", "#DCE6F2", "#C6D9F1", "#8EB4E3", "#558ED5", "#376092", "#1F497D", "#254061", "#10253F", "#CCC1DA", "#B3A2C7", "#604A7B", "#403152", "#D99694", "#953735", "#F9FDD1", "#F9F383", "#F5F018", "#FFFF00", "#DBEEF4", "#B7DEE8", "#93CDDD", "#4BACC6", "#31859C", "#215968", "#C3D69B", "#77933C", "#FAC090", "#E46C0A", "#D9D9D9", "#A6A6A6"];
    var tableAttributes = tableAttributesCreator('table-attributes');
    tableAttributes.showOnlyTheseColumns();
    document.addEventListener('DOMContentLoaded', function() {
      initPieChart.draw({
        data: getScores(), // Get the score data
        colors: criteriaColors,
        element: 'criteria-pie'
      });
      if (document.body.getAttribute('data-restore') === 'true') {
        fegsScopingController.importData();
      }
    });
    updateStakeholderProgress();
    updateWeightingProgress();
    updateBeneficiaryProgress();
    updateAttributeProgress();

    function round(number, precision) {
      var shift = function(number, precision, reverseShift) {
        if (reverseShift) {
          precision = -precision;
        }
        var numArray = ("" + number).split("e");
        return +(numArray[0] + "e" + (numArray[1] ? (+numArray[1] + precision) : precision));
      };
      return shift(Math.round(shift(number, precision, false)), precision, true);
    }
  </script>
  <script>
    var userAgent = navigator.userAgent.toLowerCase();
    if (userAgent.indexOf(' electron/') > -1) { // true if in NODE's ELECTRON
      document.getElementById('zoomer').removeAttribute('hidden');
      var {
        ipcRenderer,
        remote
      } = require('electron');

      var webFrame = require('electron').webFrame

      var indicatePageZoom = function(event) {
        document.querySelector('#page-zoom-indicator').innerText = parseInt(event.target.value * 100) + "%";
      };

      var pageZoomChange = function(event) {
        webFrame.setZoomFactor(+event.target.value);
      };

      if (remote.process.argv[1].substr(remote.process.argv[1].length - 5) === ".fegs") {
        fegsScopingView.restoreView(remote.process.argv[1]);
        fegsScopingView.indicateSaved();
      }

      // Listen for save as from main process
      ipcRenderer.on('save-as', (event, arg) => {
        fegsScopingData.filePath = arg;
        fegsScopingController.saveJSON(arg, fegsScopingData);
        fegsScopingView.indicateSaved();
      });

      // Listen for save from main process
      ipcRenderer.on('save', (event, arg) => {
        if (fegsScopingData.filePath != '') {
          fegsScopingController.saveJSON(fegsScopingData.filePath, fegsScopingData);
          fegsScopingView.indicateSaved();
        } else {
          ipcRenderer.send('save-as');
        }
      });

      // Listen for open file from main process
      ipcRenderer.on('open-file', (event, arg) => {
        fegsScopingView.restoreView(arg[0]);
        fegsScopingView.indicateSaved();
      });
    }
  </script>
</body>

</html>